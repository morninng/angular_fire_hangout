"use strict";function set_mapping_data(a,b){var c=new Firebase("https://mixidea.firebaseio.com/"),d=c.child("event_related/hangout_dynamic/"+global_event_id+"/mapping_data/"+global_own_user_id);d.set(b,function(c){c?alert("mapping failed"+c):(console.log("hangout id "+b+" is set"),console.log("with firebase user id "+a+" is set"))}),d.onDisconnect().remove()}angular.module("angularFireHangoutApp",["ngAnimate","ui.router","firebase","ngSanitize"]),angular.module("angularFireHangoutApp").run(["$state","MixideaSetting","$window",function(a,b,c){function d(b,c){switch(b){case"main":switch(c){case"introduction":a.go("main.introduction");break;case"preparation":a.go("main.preparation");break;case"debate":a.go("main.debate");break;case"reflection":a.go("main.reflection");break;case"complete":a.go("main.complete")}break;case"team_discussion":a.go("team_discussion.room")}}global_firebase_root_ref=new c.Firebase(b.firebase_url),console.log("mixidea setting"),console.log(b);var e=b.event_id,f=b.room_type;if("main"==f){var g=new Firebase(b.firebase_url),h=g.child("event_related/game/"+e+"/game_status");h.once("value",function(a){var b=a.val();d(f,b)},function(a){alert("event is corrupted, please confirm with mixidea administrator")})}else"team_discussion"==f&&(console.log("team_discuss_team_side : "+b.team_discuss_team_side),console.log("team_discuss_own_team : "+b.team_discuss_own_team),a.go("team_discussion.room"))}]),angular.module("angularFireHangoutApp").config(["$stateProvider","MixideaSetting",function(a,b){a.state("main",{views:{RootView:{templateUrl:b.source_domain+"views/main/layout_main_room.html",controller:"MainlayoutSizeadjustCtrl"}}}).state("main.introduction",{views:{top_left:{templateUrl:b.source_domain+"views/common/title.html",controller:"TitleMgrCtrl"},container_second_top:{templateUrl:b.source_domain+"views/common/status-bar.html",controller:"StatusbarCtrl"},container_main_left_above_left_up:{templateUrl:b.source_domain+"views/main/video_static.html",controller:"StaticvideoCtrl"},container_main_left_above_right:{templateUrl:b.source_domain+"views/main/direction_intro.html",controller:"StatusUpdateCtrl"},container_main_left_below:{templateUrl:b.source_domain+"views/main/info_intro.html"},container_main_right:{templateUrl:b.source_domain+"views/main/participant_table.html",controller:"ParticipantTableParentCtrl"}}}).state("main.preparation",{views:{top_left:{templateUrl:b.source_domain+"views/common/title.html",controller:"TitleMgrCtrl"},container_second_top:{templateUrl:b.source_domain+"views/common/status-bar.html",controller:"StatusbarCtrl"},container_main_left_above_left_up:{templateUrl:b.source_domain+"views/main/video_static.html",controller:"StaticvideoCtrl"},container_main_left_above_right:{templateUrl:b.source_domain+"views/main/direction_prep.html",controller:"StatusUpdateCtrl"},container_main_left_below:{templateUrl:b.source_domain+"views/main/info_prep.html",controller:"LinkTeamdiscussCtrl"},container_main_right:{templateUrl:b.source_domain+"views/main/participant_table.html",controller:"ParticipantTableParentCtrl"}}}).state("main.debate",{views:{top_left:{templateUrl:b.source_domain+"views/common/title_fix.html",controller:"TitleMgrCtrl"},top_right:{templateUrl:b.source_domain+"views/main/direction_debate.html",controller:"StatusUpdateCtrl"},container_second_top:{templateUrl:b.source_domain+"views/common/status-bar.html",controller:"StatusbarCtrl"},container_main_left_above_left_up:{templateUrl:b.source_domain+"views/main/video_debate.html",controller:"VideodebateCtrl"},container_main_left_above_left_below:{templateUrl:b.source_domain+"views/main/impression_expression.html",controller:"ImpressionExpressionCtrl"},container_main_right:{templateUrl:b.source_domain+"views/main/layout_debate_tab_right_main.html",controller:"TabDebaterightmainCtrl"},absolute_pain_1:{templateUrl:b.source_domain+"views/main/debater_bar.html",controller:"DebaterbarCtrl"}}}).state("main.debate.own_note",{views:{debate_raight_main_content:{templateUrl:b.source_domain+"views/main/own_note.html",controller:"OwnnoteCtrl"}}}).state("main.debate.prep_note",{views:{debate_raight_main_content:{templateUrl:b.source_domain+"views/team_discussion/t_room_arguments.html",controller:"TeamdiscussArgumentsCtrl"}}}).state("main.reflection",{views:{top_left:{templateUrl:b.source_domain+"views/common/title_fix.html",controller:"TitleMgrCtrl"},top_right:{templateUrl:b.source_domain+"views/main/direction_reflection.html",controller:"StatusUpdateCtrl"},container_second_top:{templateUrl:b.source_domain+"views/common/status-bar.html",controller:"StatusbarCtrl"},container_main_right:{templateUrl:b.source_domain+"views/main/layout_reflec_tab.html",controller:"ReflecTabCtrl"}}}).state("main.reflection.write_article",{views:{reflec_tab_first:{templateUrl:b.source_domain+"views/main/url_sharing.html",controller:"UrlSharingCtrl"},reflec_tab_second:{templateUrl:b.source_domain+"views/main/article_writing.html",controller:"ArticleWritingCtrl"}}}).state("main.reflection.own_note",{views:{reflec_tab_first:{templateUrl:b.source_domain+"views/main/own_note.html",controller:"OwnnoteCtrl"}}}).state("main.complete",{views:{top_left:{templateUrl:b.source_domain+"views/common/title_fix.html",controller:"TitleMgrCtrl"},top_right:{templateUrl:b.source_domain+"views/main/direction_complete.html",controller:"StatusUpdateCtrl"},container_second_top:{templateUrl:b.source_domain+"views/common/status-bar.html",controller:"StatusbarCtrl"}}}).state("team_discussion",{views:{RootView:{templateUrl:b.source_domain+"views/team_discussion/t_room_layout.html"}}}).state("team_discussion.room",{views:{team_discuss_first:{templateUrl:b.source_domain+"views/team_discussion/room_name.html",controller:"TeamdiscussRoomnameCtrl"},second_left:{templateUrl:b.source_domain+"views/team_discussion/t_room_motion.html",controller:"TitleMgrCtrl"},second_middle:{templateUrl:b.source_domain+"views/team_discussion/t_room_link_main_room.html",controller:"LinkMainroomCtrl"},second_right:{templateUrl:b.source_domain+"views/team_discussion/t_room_count_prep_time.html",controller:"CountPreptimeCtrl"},container_main:{templateUrl:b.source_domain+"views/team_discussion/t_room_arguments.html",controller:"TeamdiscussArgumentsCtrl"}}})}]),angular.module("angularFireHangoutApp").controller("ArticleWritingCtrl",["$scope","ParticipantMgrService","MixideaSetting","$timeout",function(a,b,c,d){function e(){if(a.argument_id_data){switch(a.debate_style){case"NA":var b=Object.keys(a.argument_id_data.NA.Gov.def_intro)[0];if(b){var c={arg_id:b,event_id:f,team:"Gov",deb_style:"NA"};a.NA_Gov_def_intro=c}a.NA_Gov_arguments.length=0;for(var e=Object.keys(a.argument_id_data.NA.Gov.arguments),g=0;g<e.length;g++){var c={arg_id:e[g],event_id:f,team:"Gov",deb_style:"NA"};a.NA_Gov_arguments.push(c)}a.NA_Opp_arguments.length=0;for(var h=Object.keys(a.argument_id_data.NA.Opp.arguments),g=0;g<h.length;g++){var c={arg_id:h[g],event_id:f,team:"Opp",deb_style:"NA"};a.NA_Opp_arguments.push(c)}break;case"Asian":var b=Object.keys(a.argument_id_data.Asian.Prop.def_intro)[0];if(b){var c={arg_id:b,event_id:f,team:"Prop",deb_style:"Asian"};a.Asian_Prop_def_intro=c}a.Asian_Prop_arguments.length=0;for(var i=Object.keys(a.argument_id_data.Asian.Prop.arguments),g=0;g<i.length;g++){var c={arg_id:i[g],event_id:f,team:"Prop",deb_style:"Asian"};a.Asian_Prop_arguments.push(c)}a.Asian_Opp_arguments.length=0;for(var j=Object.keys(a.argument_id_data.Asian.Opp.arguments),g=0;g<j.length;g++){var c={arg_id:j[g],event_id:f,team:"Opp",deb_style:"Asian"};a.Asian_Opp_arguments.push(c)}break;case"BP":var b=Object.keys(a.argument_id_data.BP.OG.def_intro)[0];if(b){var c={arg_id:b,event_id:f,team:"OG",deb_style:"BP"};a.BP_OG_def_intro=c}a.BP_OG_arguments.length=0;for(var k=Object.keys(a.argument_id_data.BP.OG.arguments),g=0;g<k.length;g++){var c={arg_id:k[g],event_id:f,team:"OG",deb_style:"BP"};a.BP_OG_arguments.push(c)}a.BP_OO_arguments.length=0;for(var l=Object.keys(a.argument_id_data.BP.OO.arguments),g=0;g<l.length;g++){var c={arg_id:l[g],event_id:f,team:"OO",deb_style:"BP"};a.BP_OO_arguments.push(c)}a.BP_CG_arguments.length=0;for(var m=Object.keys(a.argument_id_data.BP.CG.arguments),g=0;g<m.length;g++){var c={arg_id:m[g],event_id:f,team:"CG",deb_style:"BP"};a.BP_CG_arguments.push(c)}a.BP_CO_arguments.length=0;for(var n=Object.keys(a.argument_id_data.BP.CO.arguments),g=0;g<n.length;g++){var c={arg_id:n[g],event_id:f,team:"CO",deb_style:"BP"};a.BP_CO_arguments.push(c)}}d(function(){})}}a.participant_mgr=b,a.debate_style=a.participant_mgr.debate_style,a.argument_id_data=null,a.NA_Gov_def_intro=null,a.NA_Gov_arguments=[],a.NA_Opp_arguments=[],a.Asian_Prop_def_intro=null,a.Asian_Prop_arguments=[],a.Asian_Opp_arguments=[],a.BP_OG_def_intro=null,a.BP_OG_arguments=[],a.BP_OO_arguments=[],a.BP_CG_arguments=[],a.BP_CO_arguments=[];var f=c.event_id,g="event_related/Article_Context/"+f+"/identifier/",h=global_firebase_root_ref.child(g);h.on("value",function(b){a.argument_id_data=b.val(),e(),a.$watch("participant_mgr.debate_style",function(b,c){a.debate_style=b,e()})}),a.add_argument=function(a,b){var c="event_related/Article_Context/"+f+"/identifier/"+a+"/"+b+"/arguments",d=root_ref.child(c),e={dummy:!0};d.push(e)},a.$on("$destroy",function(){h.off("value")})}]),angular.module("angularFireHangoutApp").controller("CountPreptimeCtrl",["$scope","MixideaSetting","$timeout",function(a,b,c){a.prep_time="start preparation";var d=null,e=global_firebase_root_ref.child("event_related/hangout_dynamic/"+b.event_id+"/preparation_timer/");e.on("value",function(a){d=a.val()},function(){console.log("fail to load timer data")});var f=setInterval(function(){if(d){var b=Date.now(),e=b-d;if(!(0>e)){var f=e/1e3,g=f/60/60;g=Math.floor(g);var h=(f-60*g*60)/60;h=Math.floor(h),f=f-60*g*60-60*h,f=Math.floor(f),f=("0"+f).slice(-2),h=("0"+h).slice(-2),a.prep_time=h+":"+f+" has passed",c(function(){})}}},1e3);a.$on("$destroy",function(){clearInterval(f),e.off("value")})}]),angular.module("angularFireHangoutApp").controller("DebaterbarCtrl",["$scope","ParticipantMgrService","MixideaSetting","$timeout","SpeechStatusService",function(a,b,c,d,e){function f(){if(a.participant_mgr)switch(a.participant_mgr.debate_style){case"NA":for(var b=0;b<g.length;b++)a.debater_array.push({role_name:g[b],role_state:"normal"});break;case"Asian":for(var b=0;b<h.length;b++)a.debater_array.push({role_name:h[b],role_state:"normal"});break;case"BP":for(var b=0;b<i.length;b++)a.debater_array.push({role_name:i[b],role_state:"normal"})}}a.participant_mgr=b,a.debater_array=[],a.speech_status=e,a.cancel_style_watch=a.$watch("participant_mgr.debate_style",function(){f()});var g=["PM","LO","MG","MO","PMR","LOR"],h=["PM","LO","DPM","DLO","GW","OW","LOR","PMR"],i=["PM","LO","DPM","DLO","MG","MO","GW","OW"];a.$on("$destroy",function(){a.cancel_style_watch()})}]),angular.module("angularFireHangoutApp").controller("ImpressionExpressionCtrl",["$scope","MixideaSetting","SoundPlayService","ParticipantMgrService","$timeout",function(a,b,c,d,e){a.participant_mgr=d,a.hearhear_users_array=new Array,a.booboo_users_array=new Array;var f=global_firebase_root_ref.child("event_related/hangout_dynamic/"+b.event_id+"/impression_expression"),g=f.child("hearhear"),h=g.child(b.own_user_id),i=f.child("booboo"),j=i.child(b.own_user_id);a.click_hearhear=function(){console.log("hearhear"),h.set(!0),h.onDisconnect().set(null),setTimeout(function(){h.set(null)},2e3)},a.click_booboo=function(){j.set(!0),j.onDisconnect().set(null),setTimeout(function(){j.set(null)},2e3)};var k=0,l=0;g.on("value",function(b){var d=b.val();a.hearhear_users_array.length=0;for(var f in d)a.hearhear_users_array.push(f);a.hearhear_users_array.length>k&&c.HearHear(),k=a.hearhear_users_array.length,e(function(){})},function(a){console.log(a)}),i.on("value",function(b){var d=b.val();a.booboo_users_array.length=0;for(var f in d)a.booboo_users_array.push(f);a.booboo_users_array.length>l&&c.BooBoo(),l=a.booboo_users_array.length,e(function(){})},function(a){console.log(a)}),a.$on("$destroy",function(){i.off("value"),g.off("value")})}]),angular.module("angularFireHangoutApp").controller("LinkTeamdiscussCtrl",["$scope","ParticipantMgrService","MixideaSetting","$timeout","SpeechStatusService",function(a,b,c,d,e){function f(){if(0!=g.length){a.team_hangout_array.length=0;var b="?gid=",e=c.hangout_appid,f="&gd=",h=c.own_user_id,i=c.event_id,j="team_discussion",k=a.participant_mgr.own_group;if("Audience"==a.participant_mgr.is_audience_or_debater)for(var l=0;l<a.participant_mgr.all_group_name_array.length;l++){var m=new Object;m.name=a.participant_mgr.all_group_name_array[l];var n=a.participant_mgr.all_group_name_array[l],o=g[l];m.hangout_url=o+b+e+f+h+"^"+i+"^"+j+"^"+n+"^"+k,a.team_hangout_array.push(m)}else{var m=new Object;m.name=a.participant_mgr.own_group;var n=a.participant_mgr.own_group,o=g[a.participant_mgr.own_group_id];m.hangout_url=o+b+e+f+h+"^"+i+"^"+j+"^"+n+"^"+k,a.team_hangout_array.push(m)}d(function(){})}}a.participant_mgr=b,a.team_hangout_array=new Array;var g=(new Object,new Array);a.cancel_group_watch=a.$watch("participant_mgr.own_group",function(a,b){f()});var h=global_firebase_root_ref.child("event_related/game_hangout_obj_list/"+c.event_id+"/team_discussion");h.on("value",function(a){g=a.val(),f()},function(a){console.log("The read failed: "+a.code)}),a.$on("$destroy",function(){h.off("value"),a.cancel_group_watch()}),a.show_explanation=!1,a.teamlink_enter=function(){a.show_explanation=!0,console.log("teamlink_enter")},a.teamlink_leave=function(){a.show_explanation=!1,console.log("teamlink_leave")},e.Clear_AllSpeechData()}]),angular.module("angularFireHangoutApp").controller("MainlayoutSizeadjustCtrl",["$scope","StatusMgrService","$timeout",function(a,b,c){a.game_status_service=b,a.$watch("game_status_service.game_status",function(b,d){switch(b){case"introduction":a.top_right_width={width:"0px"},a.main_left_above_left_width={width:"300px"},a.main_left_above_right_width={width:"250px"},a.main_left_below_width={width:"550px"},a.main_right_width={width:"550px"};break;case"preparation":a.top_right_width={width:"0px"},a.main_left_above_left_width={width:"300px"},a.main_left_above_right_width={width:"250px"},a.main_left_below_width={width:"550px"},a.main_right_width={width:"550px"};break;case"debate":a.top_right_width={width:"250px"},a.main_left_above_left_width={width:"300px"},a.main_left_above_right_width={width:"0px"},a.main_left_below_width={width:"0px"},a.main_width={width:null},a.main_right_width={width:null};break;case"reflection":a.top_right_width={width:"250px"},a.main_left_above_left_width={width:"0px"},a.main_left_above_right_width={width:"0px"},a.main_left_below_width={width:"0px"},a.main_width={width:"100%"},a.main_right_width={width:"100%"};break;case"complete":a.top_right_width={width:"250px"}}c(function(){})})}]),angular.module("angularFireHangoutApp").controller("OwnnoteCtrl",["$scope","MixideaSetting","$timeout","ParticipantMgrService",function(a,b,c,d){function e(){switch(a.participant_mgr.debate_style){case"NA":a.role_obj_array=f;break;case"Asian":a.role_obj_array=g;break;case"BP":a.role_obj_array=h}}console.log("own_note"),a.role_obj_array=new Array,a.current_role=null,a.participant_mgr=d;var f=[{name:"PM",shown_name:"Prime Minister"},{name:"LO",shown_name:"Leader Opposition"},{name:"MG",shown_name:"Member Government"},{name:"MO",shown_name:"Member Opposition"},{name:"LOR",shown_name:"Leader Opposition Reply"},{name:"PMR",shown_name:"Prime Minister Reply"}],g=[{name:"PM",shown_name:"Prime Minister"},{name:"LO",shown_name:"Leader Opposition"},{name:"DPM",shown_name:"Depty Prime Minister"},{name:"DLO",shown_name:"Depty Leader Opposition"},{name:"GW",shown_name:"Government Whip"},{name:"OW",shown_name:"Opposition Whip"},{name:"LOR",shown_name:"Leader Opposition Reply"},{name:"PMR",shown_name:"Prime Minister Reply"}],h=[{name:"PM",shown_name:"Prime Minister"},{name:"LO",shown_name:"Leader Opposition"},{name:"DPM",shown_name:"Depty Prime Minister"},{name:"DLO",shown_name:"Depty Leader Opposition"},{name:"MG",shown_name:"Member Government"},{name:"MO",shown_name:"Member Opposition"},{name:"GW",shown_name:"Government Whip"},{name:"OW",shown_name:"Opposition Whip"}];a.cancel_style_watch=a.$watch("participant_mgr.debate_style",function(){e()});var i=global_firebase_root_ref.child("event_related/hangout_dynamic/"+b.event_id+"/video_status"),j=i.child("speaker");j.on("value",function(b){var d=b.val(),e=null;if(d)for(var f in d)var e=d[f].role;a.current_role=e,c(function(){})},function(a){console.log("fail while to retrieve speaker obj"+a)}),a.$on("$destroy",function(){j.off("value"),a.cancel_style_watch()})}]),angular.module("angularFireHangoutApp").controller("ParticipantTableParentCtrl",["$scope","MixideaSetting","ParticipantMgrService",function(a,b,c){function d(){a.change_shown=!1}a.participant_mgr=c,a.change_shown=!1,a.participant_mgr=c,a.show_change_style=function(){a.change_shown=!0},a.change_style=function(b){console.log("change style clicked :  "+b),a.change_shown=!1,a.participant_mgr.set_style(b)},a.mouseout_change_style=function(){d()},a.cancel_change_style=function(){d()},a.$on("$destroy",function(){console.log("destroy parent table is called")})}]),angular.module("angularFireHangoutApp").controller("ParticipantTableChildCtrl",["$scope","ParticipantMgrService","MixideaSetting",function(a,b,c){function d(b){var d=global_firebase_root_ref.child("event_related/participants/"+c.event_id+"/game_role/"+a.participant_mgr.debate_style+"/"+b);d.set(null,function(a){a?console.log("cannot cancel"+a):console.log("cancel succed")})}a.participant_mgr=b,a.own_user_id=c.own_user_id,a.join=function(b){var d=global_firebase_root_ref.child("event_related/participants/"+c.event_id+"/game_role/"+a.participant_mgr.debate_style+"/"+b);d.transaction(function(a){return a?void alert("someone has already take this role"):c.own_user_id})},a.cancel=function(a){d(a)},a.decline=function(a){d(a)},a.$on("$destroy",function(){console.log("destroy child table is called")})}]),angular.module("angularFireHangoutApp").controller("ReflecTabCtrl",["$scope","$timeout",function(a,b){function c(){var c=document.getElementById("container_main_right"),d=c.offsetTop,e=window.innerHeight,f=e-d-10,g=document.getElementById("reflec_tab_container");if(g){var h=g.offsetHeight,i=f-h,j=Math.abs(i),k=c.offsetLeft,l=window.innerWidth,m=l-k-10,n=g.offsetWidth,o=m-n,p=Math.abs(o);if(j>5||p>5){var q=String(f)+"px",r=String(m)+"px";a.layout_style={height:q,width:r,overflow:"scroll"},b(function(){})}}}c(),setTimeout(c,1e3);var d=document.getElementById("reflec_tab_container");d.addEventListener("scroll",c),a.$on("$destroy",function(){console.log("reflec tab destroy"),d.removeEventListener("scroll",c)})}]),angular.module("angularFireHangoutApp").controller("StatusUpdateCtrl",["$scope","MixideaSetting",function(a,b){function c(){var a=Date.now(),c=global_firebase_root_ref.child("event_related/hangout_dynamic/"+b.event_id+"/preparation_timer/");c.set(a,function(a){a?console.log("setting time failed"+a):console.log("set time succeed")})}var d=global_firebase_root_ref.child("event_related/game/"+b.event_id+"/game_status");a.update_status=function(a){"preparation"==a&&c(),console.log(a),d.set(a,function(a){a&&console.log("saving status failed"+a)}),b.hangout_execution&&gapi.hangout.data.submitDelta({game_status:a})}}]),angular.module("angularFireHangoutApp").controller("StatusbarCtrl",["$scope","StatusMgrService","$timeout",function(a,b,c){a.status_intro="status_bar_element",a.status_prep="status_bar_element",a.status_debate="status_bar_element",a.status_reflec="status_bar_element",a.status_complete="status_bar_element_last",a.game_status_service=b,a.cancel_status_watch=a.$watch("game_status_service.game_status",function(b,d){switch(a.status_intro="status_bar_element",a.status_prep="status_bar_element",a.status_debate="status_bar_element",a.status_reflec="status_bar_element",a.status_complete="status_bar_element_last",b){case"introduction":a.status_intro="status_bar_element_selected";break;case"preparation":a.status_prep="status_bar_element_selected";break;case"debate":a.status_debate="status_bar_element_selected";break;case"reflection":a.status_reflec="status_bar_element_selected";break;case"complete":a.status_complete="status_bar_element_selected"}c(function(){})}),a.$on("$destroy",function(){a.cancel_status_watch()})}]),angular.module("angularFireHangoutApp").controller("TabDebaterightmainCtrl",["$scope","ParticipantMgrService","$state","$timeout",function(a,b,c,d){function e(){var b=a.participant_mgr.own_group,d=a.participant_mgr.is_audience_or_debater;b&&d&&("debater"==d?c.go("main.debate.prep_note"):c.go("main.debate.own_note"))}function f(){var b=document.getElementById("container_main_right"),c=b.offsetTop,e=window.innerHeight,f=e-c-10,g=document.getElementById("debate_right_main_container"),h=g.offsetHeight,i=f-h,j=Math.abs(i),k=b.offsetLeft,l=window.innerWidth,m=l-k-50,n=g.offsetWidth,o=m-n,p=Math.abs(o);if(j>5||p>5){var q=String(f)+"px",r=String(m)+"px";a.layout_style={height:q,width:r,overflow:"scroll"},d(function(){})}}a.participant_mgr=b,a.layout_style=null,a.cancel_group_watch=a.$watch("participant_mgr.own_group",function(){e()}),a.cancel_aud_deb_watch=a.$watch("participant_mgr.is_audience_or_debater",function(){e()}),f(),setTimeout(f,1e3);var g=document.getElementById("debate_right_main_container");g.onscroll=function(){f()},e(),a.$on("$destroy",function(){a.cancel_group_watch(),a.cancel_aud_deb_watch()})}]),angular.module("angularFireHangoutApp").controller("TitleMgrCtrl",["$scope","MixideaSetting","$timeout","TitleService",function(a,b,c,d){function e(){var b=d.motion_screen.length,c=0;c=b>45?45:b>20?b:20;var e=String(c)+"em";a.dynamic_width={width:e}}a.under_edit=!1,a.dynamic_width=new Object,a.title_data=d,a.on_motion_change=function(){e()},a.edit_start=function(){d.edit_start(),a.under_edit=!0,e()},a.save=function(){d.save(),a.under_edit=!1},a.cancel=function(){d.cancel(),a.under_edit=!1}}]),angular.module("angularFireHangoutApp").controller("UrlSharingCtrl",["$scope","$http","MixideaSetting","$timeout",function(a,b,c,d){function e(){var d=a.str_url;a.str_url=null;var e=f(d);e&&b({method:"Get",url:c.recording_domain+"set_ogp",params:{url:d,event_id:c.event_id}}).success(function(a){console.log("success "+a)}).error(function(a){console.log(a)})}function f(a){var b=/((http|https):\/\/)?[A-Za-z0-9\.-]{3,}\.[A-Za-z]{2}/;return a.indexOf(" ")<0&&b.test(a)}function g(b){var c=global_firebase_root_ref.child("url_related/url/"+b);c.on("value",function(b){var c=b.val();d(function(){a.ogp_data_array.push(c)})},function(a){console.log("The read failed: "+a.code)})}a.ogp_data_array=new Array,a.url_share=null;var h=global_firebase_root_ref.child("event_related/url_link/"+c.event_id);h.on("child_added",function(a,b){var c=a.key();console.log(c),g(c)}),a.input_url_Key=function(a){13==a.which&&e()},a.click_share=function(){e()},a.$on("$destroy",function(){h.off("child_added")})}]),angular.module("angularFireHangoutApp").controller("VideodebateCtrl",["$scope","MixideaSetting","ParticipantMgrService","$timeout","SoundPlayService","RecognitionService","UtilService","RecordingService","HangoutService","$firebaseObject","SpeechStatusService",function(a,b,c,d,e,f,g,h,i,j,k){function l(){a.speech_status.poi_speaker_obj.id?("speech"==a.status&&o(),u(a.speech_status.poi_speaker_obj.id,"poi"),a.status="poi"):a.speech_status.speaker_obj.id?("break"==a.status?m():"poi"==a.status&&p(),u(a.speech_status.speaker_obj.id,"speech"),a.status="speech"):("break"!=a.status&&n(),u(null,"break"),a.status="break"),setTimeout(q,100),setTimeout(q,1e3),d(function(){})}function m(){r(),e.SpeechStart()}function n(){s()}function o(){e.Taken()}function p(){e.PoiFinish()}function q(){var a=document.getElementById("container_second_top"),b=a.offsetHeight,c=document.getElementById("container_top"),d=c.offsetHeight,e=document.getElementById("start_speech_container"),f=e.offsetHeight,g=document.getElementById("speaker_data_container"),h=g.offsetHeight,j=document.getElementById("complete_button_container"),k=j.offsetHeight,l=k+h+f+d+b;i.set_video_position(0,l)}function r(){a.timer_value="speech start",A||(B=0,A=setInterval(function(){t()},1e3))}function s(){B=0,d(function(){a.timer_value=null}),clearInterval(A),A=null}function t(){B++;var b=B%60,c=(B-b)/60,f=b,g=c+"min "+f+"sec";1==c&&0==f||6==c&&0==f?(e.PinOne(),console.log("one minutes")):7==c&&0==f?(e.PinTwo(),console.log("seven minutes")):7==c&&30==f&&(e.PinThree(),console.log("seven and half minutes")),d(function(){a.timer_value=g})}function u(c,d){var e=a.participant_mgr.debate_style;c==b.own_user_id?(f.start(e,d,a.speech_status.speaker_obj.role,a.speech_status.speaker_obj.speech_start_time),h.record_start_api(d,a.speech_status.speaker_obj.role,a.speech_status.speaker_obj.speech_start_time),i.enable_microphone()):c?(f.stop(),h.record_finish_api("other",e),i.disable_microphone()):(f.stop(),h.record_finish_api("break",e),i.enable_microphone())}a.participant_mgr=c,a.own_user_id=b.own_user_id,a.speech_status=k,a.status="break",a.timer_value=null,k.initial_execution(),a.speech_start=function(a){k.speech_start(a)},a.complete_speech=function(){k.complete_speech()},a.$watch("speech_status.watch_counter",function(){l()}),a.poi=function(){k.poi()},a.finish_poi=function(){k.finish_poi()},a.cancel_poi=function(){k.cancel_poi()},a.take_poi=function(a,b){k.take_poi(a,b)};var v=document.getElementById("video_canvas_dummy_layout"),w=v.offsetWidth,x=i.get_video_ratio(),y=w/x,z=y+"px";a.video_dumy_size={height:z},i.set_video_width(w),q(),i.set_video_visible(!0);var A=null,B=0;a.timer_value=null,a.$on("$destroy",function(){console.log("video scope is destroyed"),k.Finalize_Service()})}]),angular.module("angularFireHangoutApp").controller("StaticvideoCtrl",["$scope","MixideaSetting","HangoutService",function(a,b,c){function d(){var b=document.getElementById("static__dummy_layout"),d=300;b&&(d=b.offsetWidth);var e=c.get_video_ratio,f=d/e,g=f+"px";a.video_dumy_size={height:g},c.set_video_width(d)}function e(){var a=document.getElementById("container_second_top"),b=a.offsetHeight,d=document.getElementById("container_top"),e=d.offsetHeight,f=e+b;c.set_video_visible(!0),c.set_video_position(0,f)}c.set_video_visible(!0),d(),setTimeout(d,100),setTimeout(d,1e3),e(),setTimeout(e,100),setTimeout(e,1e3)}]);var global_own_user_id=null,global_event_id=null,global_room_type=null,global_own_hangout_id=null,global_team_side=null,global_own_team_side=null,global_firebase_root_ref=null;!function(){var a=gadgets.views.getParams().appData,b=a.split("^");global_own_user_id=b[0],global_event_id=b[1],global_room_type=b[2],"team_discussion"==global_room_type&&(global_team_side=b[3],global_own_team_side=b[4]),gapi.hangout.onApiReady.add(function(a){a.isApiReady&&(global_own_hangout_id=gapi.hangout.getLocalParticipantId(),set_mapping_data(global_own_user_id,global_own_hangout_id))})}(),angular.module("angularFireHangoutApp").constant("MixideaSetting",{firebase_url:"https://mixidea.firebaseio.com/",source_domain:"https://s3.amazonaws.com/mixideahangoutsource/angular_fire_hangout/app/",own_user_id:global_own_user_id,event_id:global_event_id,room_type:global_room_type,hangout_appid:"211272797315",team_discuss_team_side:global_team_side,team_discuss_own_team:global_own_team_side,recording_domain:"https://recording.mixidea.org:3000/",hangout_execution:!0}),angular.module("angularFireHangoutApp").directive("oneArgument",["$timeout","MixideaSetting","ParticipantMgrService","$sce","UtilService",function(a,b,c,d,e){return{templateUrl:d.trustAsResourceUrl(b.source_domain+"views/directive/oneArgument_directive.html"),restrict:"E",replace:!0,scope:{argument_id_obj:"=argId"},link:function(d,f,g){function h(){a(function(){var a=d.element[0].getElementsByClassName("title_p"),b=a[0].offsetHeight;b+=5;var c=String(b)+"px";d.title_height={height:c}})}function i(){var b=d.element[0].getElementsByClassName("MainArg_Content"),c=b[0].offsetHeight;c+=15,c=String(c)+"px",d.textearea_height={height:c},a(function(){})}var j=d.argument_id_obj.arg_id,k=d.argument_id_obj.event_id,l=d.argument_id_obj.deb_style,m=d.argument_id_obj.team;d.element=f,d.participant_mgr=c,d.others_writing_title=!1,d.others_writing_content=!1;var n="event_related/Article_Context/"+k+"/context/"+j,o=global_firebase_root_ref.child(n),p=o.child("title");p.on("value",function(b){a(function(){d.title=b.val(),h()})}),d.change_title=function(){d.title;d.title=d.title.replace(/(\r\n|\n|\r)/gm,""),p.set(d.title)};var q=o.child("content");q.on("value",function(b){d.content=b.val(),d.content_div=e.add_linebreak_html(d.content),i(),a(function(){})}),d.change_content=function(){var a=d.content;q.set(a)};var r="event_related/Article_Context/"+k+"/focused/"+j,s=global_firebase_root_ref.child(r),t=s.child("title");t.on("value",function(c){var e=c.val();d.others_writing_title=!1;for(var f in e)f!=b.own_user_id&&(d.others_writing_title=!0,d.others_id_title=f);d.others_writing_title?(d.show_hide_title_textarea="child_hide",d.show_hide_title_content="child_show"):(d.show_hide_title_textarea="child_show",d.show_hide_title_content="child_hide"),a(function(){})});var u=s.child("title/"+b.own_user_id);d.title_focused=function(){u.set(!0)},d.title_unfocused=function(){u.set(null)},u.onDisconnect().remove();var v=s.child("content");v.on("value",function(c){var e=c.val();d.others_writing_content=!1;for(var f in e)f!=b.own_user_id&&(d.others_writing_content=!0,d.others_id_content=f);d.others_writing_content?(d.show_hide_content_textarea="child_hide",d.show_hide_content_content="child_show"):(d.show_hide_content_textarea="child_show",d.show_hide_content_content="child_hide"),a(function(){})});var w=s.child("content/"+b.own_user_id);d.content_focused=function(){w.set(!0)},d.content_unfocused=function(){w.set(null)},w.onDisconnect().remove();var x="event_related/Article_Context/"+k+"/identifier/"+l+"/"+m+"/arguments/"+j,y=global_firebase_root_ref.child(x);d.remove_argument=function(){y.set(null)},d.$on("$destroy",function(){console.log("one argument destroy"),u.set(null),w.set(null),p.off("value"),t.off("value"),q.off("value"),v.off("value")})}}}]),angular.module("angularFireHangoutApp").directive("oneDefintro",["$timeout","MixideaSetting","ParticipantMgrService","$sce","UtilService",function(a,b,c,d,e){return{templateUrl:d.trustAsResourceUrl(b.source_domain+"views/directive/oneDefintro_directive.html"),restrict:"E",scope:{argument_id_obj:"=argId"},link:function(d,f,g){var h=d.argument_id_obj.arg_id,i=d.argument_id_obj.event_id;d.argument_id_obj.deb_style,d.argument_id_obj.team;d.element=f,d.participant_mgr=c,d.others_writing=!1;var j="event_related/Article_Context/"+i+"/context/"+h,k=global_firebase_root_ref.child(j),l=k.child("content");l.on("value",function(b){a(function(){d.content=b.val(),d.content_div=e.add_linebreak_html(d.content)})}),d.change_content=function(){var a=d.content;l.set(a)};var m="event_related/Article_Context/"+i+"/focused/"+h,n=global_firebase_root_ref.child(m),o=n.child("content");o.on("value",function(c){a(function(){var a=c.val();d.others_writing=!1;for(var e in a)e!=b.own_user_id&&(d.others_writing=!0,d.others_id=e);d.others_writing?(d.show_hide_textarea="child_hide",d.show_hide_content="child_show"):(d.show_hide_textarea="child_show",d.show_hide_content="child_hide")})});var p=n.child("content/"+b.own_user_id);d.content_focused=function(){p.set(!0),console.log("content focused")},d.content_unfocused=function(){console.log("content unfocused"),p.set(null)},p.onDisconnect().remove(),d.$on("$destroy",function(){p.set(null),l.off("value"),o.off("value")})}}}]),angular.module("angularFireHangoutApp").directive("ownNote",["$sce","MixideaSetting","$timeout","UtilService",function(a,b,c,d){return{templateUrl:a.trustAsResourceUrl(b.source_domain+"views/directive/ownNote_directive.html"),restrict:"E",scope:{role_object:"=roleObj"},link:function(a,e,f){a.shown_name=a.role_object.shown_name,
a.score=null,a.input_data=new Object,a.input_data.type="note",a.input_data.content=null,a.own_note_obj_array=new Array;var g=a.role_object.name,h="event_related/own_note/"+b.event_id+"/"+b.own_user_id+"/"+g,i=global_firebase_root_ref.child(h),j=i.child("content"),k=i.child("score");j.on("child_added",function(b){var e=new Object;e.id=b.key(),e.content=b.val().content,e.counter=b.val().counter,e.content_html=d.add_linebreak_html(e.content),e.type=b.val().type,e.under_edit=!1,a.own_note_obj_array.push(e),c(function(){})}),j.on("child_changed",function(b){for(var e=b.val(),f=b.key(),g=0;g<a.own_note_obj_array.length;g++)a.own_note_obj_array[g].id==f&&(a.own_note_obj_array[g].content=e.content,a.own_note_obj_array[g].content_html=d.add_linebreak_html(e.content),a.own_note_obj_array[g].type=e.type,a.own_note_obj_array[g].counter=e.counter,a.own_note_obj_array[g].under_edit=!1);c(function(){})}),k.once("value",function(b){var d=b.val();a.score=d,c(function(){})}),a.set_score=function(){k.set(a.score)},a.edit_save_input=function(a){var b=0;void 0!==a.counter&&(b=a.counter+1);var c={content:a.content,type:a.type,counter:b},d=j.child(a.id);d.set(c)},a.save_input=function(){var b={content:a.input_data.content,type:a.input_data.type,counter:0};j.push(b),a.input_data.content=null,a.input_data.type="note"},a.$on("$destroy",function(){j.off("child_added"),j.off("child_changed")})}}}]),angular.module("angularFireHangoutApp").directive("writingArgument",["$timeout","MixideaSetting","ParticipantMgrService","$sce","UtilService",function(a,b,c,d,e){return{templateUrl:d.trustAsResourceUrl(b.source_domain+"views/directive/writingArgument_directive.html"),restrict:"E",replace:!0,scope:{argument_id_obj:"=argId"},link:function(d,f,g){function h(){a(function(){var a=d.element[0].getElementsByClassName("title_p"),b=a[0].offsetHeight;b+=5;var c=String(b)+"px";d.title_height={height:c}})}function i(){a(function(){var a=d.element[0].getElementsByClassName("MainArg_Content"),b=a[0].offsetHeight;b+=15,b=String(b)+"px",d.textearea_height={height:b}})}function j(){a(function(){var a=d.element[0].getElementsByClassName("Refute_Content"),b=a[0].offsetHeight;b+=15,b=String(b)+"px",d.refute_height={height:b}})}var k=d.argument_id_obj.arg_id,l=d.argument_id_obj.event_id,m=d.argument_id_obj.deb_style,n=d.argument_id_obj.team;d.element=f,d.participant_mgr=c;var o="event_related/Article_Context/"+l+"/context/"+k,p=global_firebase_root_ref.child(o),q=p.child("title");q.on("value",function(b){a(function(){d.title=b.val(),h()})}),d.change_title=function(){d.title;d.title=d.title.replace(/(\r\n|\n|\r)/gm,""),q.set(d.title)},d.edit_title=function(){w.set(!0)};var r=p.child("content");r.on("value",function(b){a(function(){d.content=b.val(),d.content_div=e.add_linebreak_html(d.content),i()})}),d.change_content=function(){var a=d.content;r.set(a)},d.edit_content=function(){y.set(!0)};var s=p.child("refute");s.on("value",function(b){a(function(){d.refute=b.val(),d.refute_div=e.add_linebreak_html(d.refute),j()})}),d.change_refute=function(){var a=d.refute;s.set(a)};var t="event_related/Article_Context/"+l+"/focused/"+k,u=global_firebase_root_ref.child(t),v=u.child("title");v.on("value",function(c){a(function(){var a=c.val();d.writing_title_bymyself=!1,d.writing_title_byothers=!1;for(var e in a)e==b.own_user_id?d.writing_title_bymyself=!0:(d.writing_title_byothers=!0,d.others_id_title=e);d.writing_title_bymyself?(d.show_hide_title_textarea="child_show",d.show_hide_title_content="child_hide"):(d.show_hide_title_textarea="child_hide",d.show_hide_title_content="child_show")})});var w=u.child("title/"+b.own_user_id);d.title_unfocused=function(){w.set(null)},d.title_save=function(){w.set(null)},w.onDisconnect().remove();var x=u.child("content");x.on("value",function(c){a(function(){var a=c.val();d.writing_content_byothers=!1,d.writing_content_bymyself=!1;for(var e in a)e!=b.own_user_id?(d.writing_content_byothers=!0,d.others_id_content=e):d.writing_content_bymyself=!0;d.writing_content_bymyself?(d.show_hide_content_textarea="child_show",d.show_hide_content_content="child_hide"):(d.show_hide_content_textarea="child_hide",d.show_hide_content_content="child_show")})});var y=u.child("content/"+b.own_user_id);d.content_unfocused=function(){y.set(null)},d.save_content=function(){y.set(null)},y.onDisconnect().remove();var z=u.child("refute");z.on("value",function(c){a(function(){var a=c.val();d.writing_refute_byothers=!1;for(var e in a)e!=b.own_user_id&&(d.writing_refute_byothers=!0,d.others_id_refute=e);d.writing_refute_byothers?(d.show_hide_refute_textarea="child_hide",d.show_hide_refute_context="child_show"):(d.show_hide_refute_textarea="child_show",d.show_hide_refute_context="child_hide")})});var A=u.child("refute/"+b.own_user_id);d.refute_unfocused=function(){A.set(null)},d.refute_focused=function(){A.set(!0)};var B="event_related/Article_Context/"+l+"/identifier/"+m+"/"+n+"/arguments/"+k,C=global_firebase_root_ref.child(B);d.remove_argument=function(){C.set(null)},d.$on("$destroy",function(){q.off("value"),r.off("value"),s.off("value"),v.off("value"),x.off("value"),z.off("value"),w.set(null),y.set(null),A.set(null)})}}}]),angular.module("angularFireHangoutApp").directive("writingDefintro",["$timeout","MixideaSetting","ParticipantMgrService","$sce","UtilService",function(a,b,c,d,e){return{templateUrl:d.trustAsResourceUrl(b.source_domain+"views/directive/writingDefintro_directive.html"),restrict:"E",replace:!0,scope:{argument_id_obj:"=argId"},link:function(d,f,g){function h(){a(function(){var a=d.element[0].getElementsByClassName("defintro_Content"),b=a[0].offsetHeight;b+=5;var c=String(b)+"px";d.defintro_height={height:c}})}var i=d.argument_id_obj.arg_id,j=d.argument_id_obj.event_id;d.argument_id_obj.deb_style,d.argument_id_obj.team;d.element=f,d.participant_mgr=c;var k="event_related/Article_Context/"+j+"/context/"+i+"/content",l=global_firebase_root_ref.child(k);l.on("value",function(b){a(function(){d.defintro_content=b.val(),d.defintro_div=e.add_linebreak_html(d.defintro_content),h()})}),d.change_defintro=function(){var a=d.defintro_content;l.set(a)},d.edit_defintro=function(){o.set(!0)};var m="event_related/Article_Context/"+j+"/focused/"+i+"/def_intro",n=global_firebase_root_ref.child(m);n.on("value",function(c){a(function(){var a=c.val();d.writing_bymyself=!1,d.writing_byothers=!1;for(var e in a)e==b.own_user_id?d.writing_bymyself=!0:(d.writing_byothers=!0,d.others_id=e);d.writing_bymyself?(d.show_hide_textarea="child_show",d.show_hide_content="child_hide"):(d.show_hide_textarea="child_hide",d.show_hide_content="child_show")})});var o=n.child(b.own_user_id);d.defintro_unfocused=function(){o.set(null),console.log("content unfocused")},d.save_defintro=function(){o.set(null)},o.onDisconnect().remove(),d.$on("$destroy",function(){l.off("value"),n.off("value"),o.set(null)})}}}]),angular.module("angularFireHangoutApp").service("HangoutService",["MixideaSetting",function(a){var b=null,c=null,d=16/9;a.hangout_execution&&(b=gapi.hangout.layout.getVideoCanvas(),c=gapi.hangout.layout.getDefaultVideoFeed(),d=b.getAspectRatio()),this.get_video_ratio=function(){return d},this.set_video_width=function(c){a.hangout_execution&&b.setWidth(c)},this.set_video_position=function(c,d){a.hangout_execution&&b.setPosition(c,d)},this.set_video_visible=function(c){console.log("set_video_visible"+c),a.hangout_execution&&b.setVisible(c)},this.enable_microphone=function(){if(a.hangout_execution){var b=gapi.hangout.av.getMicrophoneMute();b&&(gapi.hangout.av.setMicrophoneMute(!1),console.log("microphone turned on"))}},this.disable_microphone=function(){if(a.hangout_execution){var b=gapi.hangout.av.getMicrophoneMute();b||(gapi.hangout.av.setMicrophoneMute(!0),console.log("microphone turned off"))}}}]),angular.module("angularFireHangoutApp").factory("ParticipantMgrService",["MixideaSetting","$timeout","$firebaseObject",function(a,b,c){function d(){var a=gapi.hangout.data.getValue("deb_style");a&&e(a)}function e(a){a!=n&&(m.debate_style=a,i(),n=a)}function f(a){for(b in m.user_object_data)delete m.user_object_data[b];m.user_object_data=null,m.user_object_data=new Object,t=0;for(var b in a)g(b),t++}function g(b){var c=o.child("users/user_basic/"+b);c.on("value",function(b){var c=b.val(),d=b.key();m.user_object_data[d]=c;var e=l(m.user_object_data);d==a.own_user_id&&(m.own_first_name=c.first_name,m.own_last_name=c.last_name),e==t&&i()},function(a){console.log("The read failed: "+a.code)})}function h(){var b=!1;for(var c in r)if(c==a.own_user_id)return void(b=!0);if(!b){var d=x.child(a.own_user_id),e=global_own_hangout_id;e||a.hangout_execution&&(e=gapi.hangout.getLocalParticipantId()),d.set(e)}}function i(){m.participant_obj=null,m.participant_obj=new Object,m.participant_obj_bp_open=null,m.participant_obj_bp_open=new Object,m.participant_obj_bp_close=null,m.participant_obj_bp_close=new Object;var c=a.source_domain+"images/want_you.png";switch(m.debate_style){case"NA":m.participant_obj={PM:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"Gov",group_id:0,side:"left",login:!1,css_style:"participant_box_default"},LO:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"Opp",group_id:1,side:"right",login:!1,css_style:"participant_box_default"},MG:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"Gov",group_id:0,side:"left",login:!1,css_style:"participant_box_default"},MO:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"Opp",group_id:1,side:"right",login:!1,css_style:"participant_box_default"},PMR:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"Gov",group_id:0,side:"left",login:!1,css_style:"participant_box_default"},LOR:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"Opp",group_id:1,side:"right",login:!1,css_style:"participant_box_default"}};var d=p.NA;d||(d=new Object),m.audience_array.length=0;break;case"Asian":m.participant_obj={PM:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"Prop",group_id:0,side:"left",login:!1,css_style:"participant_box_default"},LO:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"Opp",side:"right",group_id:1,login:!1,css_style:"participant_box_default"},DPM:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"Prop",group_id:0,side:"left",login:!1,css_style:"participant_box_default"},DLO:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"Opp",group_id:1,side:"right",login:!1,css_style:"participant_box_default"},GW:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"Prop",group_id:0,side:"left",login:!1,css_style:"participant_box_default"},OW:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"Opp",group_id:1,side:"right",login:!1,css_style:"participant_box_default"},PMR:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"Prop",group_id:0,side:"left",login:!1,css_style:"participant_box_default"},LOR:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"Opp",group_id:1,side:"right",login:!1,css_style:"participant_box_default"}};var d=p.Asian;d||(d=new Object),m.audience_array.length=0;break;case"BP":m.participant_obj={PM:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"OG",group_id:0,side:"left",part:"Opening",login:!1,css_style:"participant_box_default"},LO:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"OO",group_id:1,side:"right",part:"Opening",login:!1,css_style:"participant_box_default"},DPM:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"OG",group_id:0,side:"left",part:"Opening",login:!1,css_style:"participant_box_default"},DLO:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"OO",group_id:1,side:"right",part:"Opening",login:!1,css_style:"participant_box_default"},MG:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"CG",group_id:2,side:"left",part:"Closing",login:!1,css_style:"participant_box_default"},MO:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"CO",group_id:3,side:"right",part:"Closing",login:!1,css_style:"participant_box_default"},GW:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"CG",group_id:2,side:"left",part:"Closing",login:!1,css_style:"participant_box_default"},OW:{user_name:"no applilcant",profile_pict:c,applicant:!1,id:null,group:"CO",group_id:3,side:"right",part:"Closing",login:!1,css_style:"participant_box_default"}};var d=p.BP;d||(d=new Object),m.audience_array.length=0;break;default:return}for(var e in q){var f=!1;for(var g in d)if(e==d[g]){f=!0;break}if(!f){var h={applicant:!0,id:e,group:"Aud",login:!1,css_style:"participant_box_default"};m.audience_array.push(h)}}for(var g in d)m.participant_obj[g].id=d[g],m.participant_obj[g].applicant=!0;for(var g in m.participant_obj){var i=m.participant_obj[g].id;m.user_object_data[i]&&(m.participant_obj[g].user_name=m.user_object_data[i].first_name,m.participant_obj[g].profile_pict=m.user_object_data[i].profile_pict,m.participant_obj[g].css_style="participant_box_logoff"),r[i]&&(m.participant_obj[g].css_style="participant_box_login",m.participant_obj[g].login=!0)}for(var l=0;l<m.audience_array.length;l++){var i=m.audience_array[l].id;m.user_object_data[i]&&(m.audience_array[l].user_name=m.user_object_data[i].first_name,m.audience_array[l].profile_pict=m.user_object_data[i].profile_pict,m.audience_array[l].applicant=!0,m.audience_array[l].css_style="participant_box_logoff"),r[i]&&(m.audience_array[l].css_style="participant_box_login")}"BP"==m.debate_style&&j(),k(),b(function(){})}function j(){for(var a in m.participant_obj_bp_open)delete m.participant_obj_bp_open[a];for(var a in m.participant_obj_bp_close)delete m.participant_obj_bp_close[a];for(var b in m.participant_obj)"Opening"==m.participant_obj[b].part&&(m.participant_obj_bp_open[b]=m.participant_obj[b]),"Closing"==m.participant_obj[b].part&&(m.participant_obj_bp_close[b]=m.participant_obj[b])}function k(){switch(m.debate_style){case"NA":m.all_group_name_array=["Gov","Opp"],m.all_group_id=[0,1];break;case"Asian":m.all_group_name_array=["Prop","Opp"],m.all_group_id=[0,1];break;case"BP":m.all_group_name_array=["OG","OO","CG","CO"],m.all_group_id=[0,1,2,3]}m.own_role_array.length=0,m.own_group="Audience",m.is_audience_or_debater="Audience",m.own_side="Audience",m.own_group_id=null;for(var b in m.participant_obj)m.participant_obj[b].id==a.own_user_id&&(m.own_role_array.push(b),m.own_group=m.participant_obj[b].group,m.own_group_id=m.participant_obj[b].group_id,m.is_audience_or_debater="debater",m.own_side=m.participant_obj[b].side)}function l(a){var b=0;for(var c in a)b++;return b}var m=new Object;m.debate_style=null;var n=null;m.participant_obj=new Object,m.participant_obj_bp_open=new Object,m.participant_obj_bp_close=new Object,m.audience_array=new Array,m.own_group=null,m.is_audience_or_debater="Audience",m.own_first_name=null,m.own_last_name=null,m.all_group_name=new Array,m.own_role_array=new Array,m.all_group_name_array=new Array,m.user_object_data=new Object;var o=new Firebase(a.firebase_url),p=new Object,q=new Object,r=new Object,s=new Object,t=0,u=(new Object,null),v=global_firebase_root_ref.child("event_related/game/"+a.event_id+"/deb_style");u=c(v),u.$watch(function(){var a=u.$value;e(a)}),a.hangout_execution&&gapi.hangout.onApiReady.add(function(a){a.isApiReady&&gapi.hangout.data.onStateChanged.add(d)}),m.set_style=function(a){u.$value=a,u.$save(),gapi.hangout.data.submitDelta({deb_style:a})};var w=o.child("event_related/participants/"+a.event_id+"/full");w.on("value",function(a){var b=a.val();q=b?b:new Object,f(q)},function(a){console.log("The read failed: "+a.code)});var x=global_firebase_root_ref.child("event_related/hangout_dynamic/"+a.event_id+"/mapping_data");x.on("value",function(a){console.log("mapping data updated");var b=a.val();console.log(b);a.key();b?(r=b,y()):r=new Object,i()},function(a){console.log("The read failed: "+a.code)});var y=function(){for(var a in r)s[a]=r[a]};window.addEventListener("online",function(){console.log("online event"),h(),setTimeout(function(){h()},3e3)}),m.getUserid_fromHangoutid=function(a){for(var b in s)if(a==s[b])return b},a.hangout_execution&&gapi.hangout.onApiReady.add(function(a){a.isApiReady&&gapi.hangout.onParticipantsChanged.add(function(a){h()})});var z=global_firebase_root_ref.child("event_related/participants/"+a.event_id+"/game_role/");return z.on("value",function(a){var b=a.val();p=b?b:new Object,i()},function(a){console.log("The read failed: "+a.code)}),m}]),angular.module("angularFireHangoutApp").service("RecognitionService",["MixideaSetting",function(a){function b(){return window.webkitSpeechRecognition?(j=new webkitSpeechRecognition,j.continuous=!0,j.lang="en-US",void(j.onresult=function(a){for(var b=a.results,d=a.resultIndex;d<b.length;d++)b[d].isFinal&&c(b[d][0].transcript)})):void(e=!1)}function c(a){console.log(a);var b=Date.now(),c=b-i,d=g.child("context"),e=new Object;e[c]=a,d.update(e)}var d=!1,e=!0,f=null,g=null,h=null,i=0,j=null;this.start=function(b,c,k,l){if(e){i=l,f=Date.now(),h=c,g=global_firebase_root_ref.child("event_related/audio_transcript/"+a.event_id+"/"+b+"/"+k+"/"+String(i)+"/spech_context/"+f);var m={user:a.own_user_id,type:h};g.update(m),d||(console.log("--recognition start--"),j.start(),d=!0)}},this.stop=function(){e&&d&&setTimeout(function(){console.log("--recognition stop--"),j.stop(),d=!1},1e3)},b()}]),angular.module("angularFireHangoutApp").service("RecordingService",["MixideaSetting","SocketStreamsService",function(a,b){function c(){navigator.getUserMedia||(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia),navigator.getUserMedia?(console.log("get user media"),navigator.getUserMedia({audio:!0},function(a){f=!0,console.log("audio is a vailable by user concensus"),d(a)},function(a){console.log("using audio is blocked by user")})):console.log("getUserMedia not supported")}function d(a){var c=window.AudioContext||window.webkitAudioContext;h=new c,i=h.sampleRate;var d=h.createMediaStreamSource(a),f=4096;j=h.createScriptProcessor(f,1,1),d.connect(j),j.connect(h.destination),j.onaudioprocess=function(a){if(k){var c=a.inputBuffer.getChannelData(0),d=e(c);b.stream_record_process(d)}}}function e(a){for(var b=a.length,c=2*b,d=new Uint8Array(c),e=new Int16Array(1),f=0;b>f;f++)e[0]=32767*a[f],d[2*f]=255&e[0],d[2*f+1]=(65280&e[0])>>8;return d.buffer}var f=!1,g=null,h=null,i=null,j=null,k=!1,l=null;this.record_start_api=function(c,d,e){if(f&&b.socket_available){l=d,k=!0;var h=a.event_id+"_"+l+"_"+e;switch(c){case"speech":g==e?b.resume_record(h):b.start_record(h,i);break;case"poi":b.resume_record(h,i)}g=e}},this.record_finish_api=function(c,d){if(f&&b.socket_available&&k){k=!1;var e=a.event_id+"_"+l+"_"+g;switch(c){case"break":b.stop_record_save(e,d,l,g);break;case"other":b.suspend_record(e)}}},c()}]),angular.module("angularFireHangoutApp").factory("SocketStreamsService",["MixideaSetting",function(a){function b(){d=io.connect(a.recording_domain),d.on("connect",function(){console.log("connect socket id="+d.id),c.socket_available=!0,d.emit("join_room",{room_name:a.event_id}),d.on("audio_saved",function(a){console.log("record complete "+a.file_saved)}),d.on("disconnect",function(){console.log("disconnected"),c.socket_available=!1,e&&(console.log("disconnected"),e.end(),e=null)})})}var c=new Object;c.socket_available=!1;var d=null,e=null;return c.start_record=function(a,b){if(this.socket_available)if(e)console.log("recording is already on going");else{console.log(" start record socket id="+d.id),e=ss.createStream(),console.log("audio polling stream id "+e.id);var c={filename:a,sample_rate:b};console.log(c),ss(d).emit("audio_record_start",e,c)}},c.suspend_record=function(a){this.socket_available&&(console.log("suspend recording"),e&&(e.end(),e=null,d.emit("audio_record_suspend",{filename:a})))},c.resume_record=function(a,b){this.socket_available&&(e?console.log("recording is already on going"):(console.log("resume recording"),e=ss.createStream(),console.log("audio polling stream id "+e.id),ss(d).emit("audio_record_resume",e,{filename:a,sample_rate:b})))},c.stop_record_save=function(b,c,f,g){if(this.socket_available&&e){console.log("stop record socket id="+d.id),e.end(),e=null;var h=a.event_id,i={filename:b,deb_style:c,role_name:f,room_name:h,speech_id:g};console.log(i),d.emit("audio_record_end",i)}},c.stream_record_process=function(a){if(e){var b=new ss.Buffer(a);e.write(b,"buffer")}},b(),c}]),angular.module("angularFireHangoutApp").service("SoundPlayService",["MixideaSetting",function(a){function b(a,b,c){this.context=a,this.urlList=b,this.onload=c,this.bufferList=new Array,this.loadCount=0}function c(c,g){e=new b(f,[a.source_domain+"audio/pointofinformation.mp3",a.source_domain+"audio/hearhear.mp3",a.source_domain+"audio/shame.mp3",a.source_domain+"audio/taken.mp3",a.source_domain+"audio/gobacktospeaker.mp3",a.source_domain+"audio/OnePin.mp3",a.source_domain+"audio/TwoPin.mp3",a.source_domain+"audio/ThreePin.mp3",a.source_domain+"audio/cursor1.mp3",a.source_domain+"audio/speech_start.mp3"],d),e.load()}function d(a){g.Poi_sound=f.createBufferSource(),g.Poi_sound.buffer=a[0],g.Poi_sound_persisted_buffer=a[0],g.Poi_sound.connect(f.destination),g.HearHear_sound=f.createBufferSource(),g.HearHear_sound.buffer=a[1],g.HearHear_sound_persisted_buffer=a[1],g.HearHear_sound.connect(f.destination),g.BooBoo_sound=f.createBufferSource(),g.BooBoo_sound.buffer=a[2],g.BooBoo_sound_persisted_buffer=a[2],g.BooBoo_sound.connect(f.destination),g.Taken_sound=f.createBufferSource(),g.Taken_sound.buffer=a[3],g.Taken_sound_persisted_buffer=a[3],g.Taken_sound.connect(f.destination),g.PoiFinish_sound=f.createBufferSource(),g.PoiFinish_sound.buffer=a[4],g.PoiFinish_sound_persisted_buffer=a[4],g.PoiFinish_sound.connect(f.destination),g.PinOne_sound=f.createBufferSource(),g.PinOne_sound.buffer=a[5],g.PinOne_sound_persisted_buffer=a[5],g.PinOne_sound.connect(f.destination),g.PinTwo_sound=f.createBufferSource(),g.PinTwo_sound.buffer=a[6],g.PinTwo_sound_persisted_buffer=a[6],g.PinTwo_sound.connect(f.destination),g.PinThree_sound=f.createBufferSource(),g.PinThree_sound.buffer=a[7],g.PinThree_sound_persisted_buffer=a[7],g.PinThree_sound.connect(f.destination),g.Cursol_sound=f.createBufferSource(),g.Cursol_sound.buffer=a[8],g.Cursol_sound_persisted_buffer=a[8],g.Cursol_sound.connect(f.destination),g.SpeechStart_sound=f.createBufferSource(),g.SpeechStart_sound.buffer=a[9],g.SpeechStart_sound_persisted_buffer=a[9],g.SpeechStart_sound.connect(f.destination)}this.Poi=function(){g.PinOne_sound&&(g.Poi_sound.start(0),g.Poi_sound=f.createBufferSource(),g.Poi_sound.buffer=g.Poi_sound_persisted_buffer,g.Poi_sound.connect(f.destination),console.log("sound:::::poi"))},this.HearHear=function(){g.SpeechStart_sound&&(g.HearHear_sound.start(0),g.HearHear_sound=f.createBufferSource(),g.HearHear_sound.buffer=g.HearHear_sound_persisted_buffer,g.HearHear_sound.connect(f.destination),console.log("sound:::::hearhear"))},this.BooBoo=function(){g.SpeechStart_sound&&(g.BooBoo_sound.start(0),g.BooBoo_sound=f.createBufferSource(),g.BooBoo_sound.buffer=g.BooBoo_sound_persisted_buffer,g.BooBoo_sound.connect(f.destination),console.log("sound:::::booboo"))},this.Taken=function(){g.SpeechStart_sound&&(g.Taken_sound.start(0),g.Taken_sound=f.createBufferSource(),g.Taken_sound.buffer=g.Taken_sound_persisted_buffer,g.Taken_sound.connect(f.destination),console.log("sound:::::taken"))},this.PoiFinish=function(){g.SpeechStart_sound&&(g.PoiFinish_sound.start(0),g.PoiFinish_sound=f.createBufferSource(),g.PoiFinish_sound.buffer=g.PoiFinish_sound_persisted_buffer,g.PoiFinish_sound.connect(f.destination),console.log("sound:::::poi finish"))},this.PinOne=function(){g.SpeechStart_sound&&(g.PinOne_sound.start(0),g.PinOne_sound=f.createBufferSource(),g.PinOne_sound.buffer=g.PinOne_sound_persisted_buffer,g.PinOne_sound.connect(f.destination),console.log("sound:::::poi one"))},this.PinTwo=function(){g.SpeechStart_sound&&(g.PinTwo_sound.start(0),g.PinTwo_sound=f.createBufferSource(),g.PinTwo_sound.buffer=g.PinTwo_sound_persisted_buffer,g.PinTwo_sound.connect(f.destination),console.log("sound:::::poi two"))},this.PinThree=function(){g.SpeechStart_sound&&(g.PinThree_sound.start(0),g.PinThree_sound=f.createBufferSource(),g.PinThree_sound.buffer=g.PinThree_sound_persisted_buffer,g.PinThree_sound.connect(f.destination),console.log("sound:::::poi three"))},this.Cursol=function(){g.SpeechStart_sound&&(g.Cursol_sound.start(0),g.Cursol_sound=f.createBufferSource(),g.Cursol_sound.buffer=g.Cursol_sound_persisted_buffer,g.Cursol_sound.connect(f.destination),console.log("sound:::::cursol"))},this.SpeechStart=function(){g.SpeechStart_sound&&(g.SpeechStart_sound.start(0),g.SpeechStart_sound=f.createBufferSource(),g.SpeechStart_sound.buffer=g.SpeechStart_sound_persisted_buffer,g.SpeechStart_sound.connect(f.destination),console.log("sound:::::speech start"))},b.prototype.loadBuffer=function(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.responseType="arraybuffer";var d=this;c.onload=function(){d.context.decodeAudioData(c.response,function(c){return c?(d.bufferList[b]=c,void(++d.loadCount==d.urlList.length&&d.onload(d.bufferList))):void alert("error decoding file data: "+a)},function(a){console.error("decodeAudioData error",a)})},c.onerror=function(){alert("BufferLoader: XHR error")},c.send()},b.prototype.load=function(){for(var a=0;a<this.urlList.length;++a)this.loadBuffer(this.urlList[a],a)};var e=null;window.AudioContext=window.AudioContext||window.webkitAudioContext;var f=new AudioContext,g=new Object;c()}]),angular.module("angularFireHangoutApp").factory("SpeechStatusService",["MixideaSetting","$firebaseObject","ParticipantMgrService","UtilService","$timeout","SoundPlayService",function(a,b,c,d,e,f){var g=new Object;g.speaker_obj=new Object,g.poi_speaker_obj=new Object,g.speaker_obj.speech_start_time=0,g.watch_counter=0,g.poi_candidate_userobj_array=new Array;var h=global_firebase_root_ref.child("event_related/hangout_dynamic/"+a.event_id+"/video_status"),i=(b(h),h.child("speaker")),j=b(i),k=h.child("speaker/"+a.own_user_id),l=(b(k),h.child("poi")),m=b(l),n=h.child("poi/candidate"),o=b(n),p=h.child("poi/candidate/"+a.own_user_id),q=b(p),r=h.child("poi/taken"),s=b(r),t=h.child("poi/taken/"+a.own_user_id),u=(b(t),null),v=null;g.initial_execution=function(){a.hangout_execution&&gapi.hangout.onApiReady.add(function(a){a.isApiReady&&(gapi.hangout.data.onStateChanged.add(x),gapi.hangout.data.onStateChanged.add(z),gapi.hangout.onParticipantsRemoved.add(w),x(),z())}),v=j.$watch(function(){var a=j,b=Object.keys(a),c=b.filter(function(a){return"$"!=a.charAt(0)}),d=new Object;c.length>0&&(d[c]=j[c]),y(d)}),u=s.$watch(function(){var a=s,b=Object.keys(a),c=b.filter(function(a){return"$"!=a.charAt(0)}),d=new Object;c.length>0&&(d[c]=a[c]),A(d)})};var w=function(a){for(var b=a.removedParticipants,d=0;d<b.length;d++){var e=b[d].id,f=c.getUserid_fromHangoutid(e);f&&(g.speaker_obj&&f==g.speaker_obj.id?g.Clear_AllSpeechData():g.poi_speaker_obj&&f==g.poi_speaker_obj.id&&g.finish_poi())}},x=function(){var a=gapi.hangout.data.getValue("speaker_status");console.log("hangout speaker status"+a);var b=new Object;a&&(b=JSON.parse(a)),y(b)},y=function(a){var b=!1,c=Object.keys(a)[0];if(c)g.speaker_obj.id!=c&&(g.speaker_obj.id=c,g.speaker_obj.name=a[c].name,g.speaker_obj.role=a[c].role,g.speaker_obj.side=a[c].side,g.speaker_obj.full_role_name=a[c].full_role_name,g.speaker_obj.speech_start_time=a[c].speech_start_time,b=!0);else{g.speaker_obj.id&&(b=!0);for(var c in g.speaker_obj)delete g.speaker_obj[c];g.speaker_obj.speech_start_time=0}b&&(g.watch_counter++,e(function(){}))};g.speech_start=function(b){var e=c.own_side,f=c.own_first_name,g=d.get_full_role_name(b),h=Date.now(),i={role:b,name:f,side:e,full_role_name:g,speech_start_time:h};if(a.hangout_execution){var l=new Object;l[a.own_user_id]=i;var m=JSON.stringify(l);gapi.hangout.data.submitDelta({speaker_status:m})}j[a.own_user_id]=i,j.$save(),k.onDisconnect().set(null)},g.complete_speech=function(){a.hangout_execution&&(gapi.hangout.data.clearValue("speaker_status"),gapi.hangout.data.clearValue("poi_taken")),j.$remove(),s.$remove(),o.$remove()},g.poi=function(){var a=c.own_group;q.$value=a,q.$save(),p.onDisconnect().set(null),t.onDisconnect().set(null)},g.finish_poi=function(){a.hangout_execution&&gapi.hangout.data.clearValue("poi_taken"),m.$remove(),o.$remove()},n.on("value",function(a){var b=a.val(),c=g.poi_candidate_userobj_array.length,d=0;g.poi_candidate_userobj_array.length=0;for(var h in b){var i={id:h,group:b[h]};g.poi_candidate_userobj_array.push(i),d++}d-c>0&&f.Poi(),e(function(){})}),g.cancel_poi=function(){q.$remove()},g.take_poi=function(b,c){if(a.hangout_execution){var d=new Object;d[b]=c;var e=JSON.stringify(d);gapi.hangout.data.submitDelta({poi_taken:e})}s[b]=c,s.$save(),o.$remove()};var z=function(){var a=gapi.hangout.data.getValue("poi_taken");console.log("hangout poitaken status : "+a);var b=new Object;a&&(b=JSON.parse(a)),A(b)},A=function(a){var b=Object.keys(a)[0],c=!1;if(b){if(g.poi_speaker_obj.id!=b){var d=b,f=a[d];g.poi_speaker_obj.id=d,g.poi_speaker_obj.speaker_group="Poi from "+f,c=!0}}else{g.poi_speaker_obj&&g.poi_speaker_obj.id&&(c=!0);for(var b in g.poi_speaker_obj)delete g.poi_speaker_obj[b]}c&&(g.watch_counter++,e(function(){}))};return g.Clear_AllSpeechData=function(){a.hangout_execution&&(gapi.hangout.data.clearValue("speaker_status"),gapi.hangout.data.clearValue("poi_taken")),j.$remove(),s.$remove(),o.$remove()},g.Finalize_Service=function(){a.hangout_execution&&(gapi.hangout.data.clearValue("speaker_status"),gapi.hangout.data.clearValue("poi_taken"),gapi.hangout.data.onStateChanged.remove(x),gapi.hangout.data.onStateChanged.remove(z),gapi.hangout.onParticipantsRemoved.remove(w)),j.$remove(),s.$remove(),v(),u(),o.$remove(),n.off("value")},g}]),angular.module("angularFireHangoutApp").factory("StatusMgrService",["MixideaSetting","$state","HangoutService","SoundPlayService",function(a,b,c,d){function e(){var a=gapi.hangout.data.getValue("game_status");console.log("game status from hangout : "+a),a&&f(a)}function f(a){a!=g.game_status&&(g.game_status=a,"reflection"==a?b.go("main.reflection.write_article"):b.go("main."+a),("reflection"==a||"complete"==a)&&c.set_video_visible(!1),d.Cursol())}var g=new Object;g.game_status=null,a.hangout_execution&&gapi.hangout.onApiReady.add(function(a){a.isApiReady&&gapi.hangout.data.onStateChanged.add(e)});var h=global_firebase_root_ref.child("event_related/game/"+a.event_id+"/game_status");return h.on("value",function(a){var b=a.val();f(b)},function(a){console.log("The read failed: "+a.code)}),g}]),angular.module("angularFireHangoutApp").factory("TitleService",["MixideaSetting","$timeout",function(a,b){var c=new Object;c.motion_server=null,c.motion_screen=null,c.style=null;var d=global_firebase_root_ref.child("event_related/game/"+a.event_id+"/motion");d.on("value",function(a){c.motion_server=a.val(),e()},function(a){console.log("The read failed: "+a.code)});var e=function(){if(c.motion_screen=c.motion_server,c.motion_server){var a=c.motion_server.length;0==a&&(c.style="motion_sentence_Red_xlarge",$scope.data.motion_screen="input motion here",c.motion_exist=!1),60>a?(c.style="motion_sentence_large",c.motion_exist=!0):100>a?(c.style="motion_sentence_middle",c.motion_exist=!0):(c.style="motion_sentence_small",c.motion_exist=!0)}else c.style="motion_sentence_Red_xlarge",c.motion_screen="input motion here",c.motion_exist=!1;b(function(){})};return c.save=function(){d.set(c.motion_screen)},c.cancel=function(){e()},c.edit_start=function(){c.motion_exist||(c.motion_screen="")},c}]),angular.module("angularFireHangoutApp").service("UtilService",function(){this.get_full_role_name=function(a){switch(a){case"PM":return"Prime Minister";case"LO":return"Leader Opposition";case"MG":return"Member Government";
case"MO":return"Member Opposition";case"PMR":return"Prime Minister Reply";case"LOR":return"Leader Opposition Reply";case"DPM":return"Depty Prime Minister";case"DLO":return"Depty Leader Opposition";case"WG":return"Whip Government";case"WO":return"Whip Opposition";case"GW":return"Govenment Whip";case"OW":return"Opposition Whip";default:return""}},this.add_linebreak_html=function(a){if(!a)return null;var b=a.split("<").join("&lt;");return b=b.split(">").join("&gt;"),b=b.split("\n").join("<br>")}}),angular.module("angularFireHangoutApp").controller("LinkMainroomCtrl",["$scope","MixideaSetting","$timeout",function(a,b,c){var d="?gid=",e=b.hangout_appid,f="&gd=",g=b.own_user_id,h=b.event_id,i="main",j=global_firebase_root_ref.child("event_related/game_hangout_obj_list/"+b.event_id+"/main");j.on("value",function(b){c(function(){var c=b.val();a.hangout_url=c+d+e+f+g+"^"+h+"^"+i})},function(a){console.log("The read failed: "+a.code)}),a.$on("$destroy",function(){j.off("value")})}]),angular.module("angularFireHangoutApp").controller("TeamdiscussArgumentsCtrl",["$scope","MixideaSetting","$timeout","ParticipantMgrService",function(a,b,c,d){function e(){var b="event_related/Article_Context/"+h+"/identifier/"+i+"/"+g+"/arguments";a.argument_id_ref=global_firebase_root_ref.child(b),a.argument_id_ref.on("child_added",function(b,d){var e=b.key();c(function(){a.arg_list.push({arg_id:e,event_id:h,team:g,deb_style:i})})}),a.argument_id_ref.on("child_removed",function(b,d){for(var e=b.key(),f=(a.arg_list,-1),g=0;g<a.arg_list.length;g++)a.arg_list[g].arg_id==e&&(f=g);-1!=f&&c(function(){a.arg_list.splice(f,1)})});var d="event_related/Article_Context/"+h+"/identifier/"+i+"/"+g+"/def_intro";a.defintro_id_ref=global_firebase_root_ref.child(d),a.defintro_id_ref.on("child_added",function(b,d){var e=b.key();c(function(){a.defintro_list.push({arg_id:e,event_id:h,team:g,deb_style:i})})}),a.add_argument=function(){console.log("add argument");var b={dummy:!0};a.argument_id_ref.push(b)}}function f(){console.log("set_pain_size");var b=document.getElementById("container_main"),d=b.offsetTop,e=window.innerHeight,f=e-d-10,g=document.getElementById("teamdiscuss_argument_container"),h=g.offsetHeight,i=f-h,j=Math.abs(i),k=0,l=window.innerWidth,m=l-k-10,n=g.offsetWidth,o=m-n,p=Math.abs(o);if(j>5||p>5){var q=String(f)+"px",r=String(m)+"px";a.layout_style={height:q,width:r,overflow:"scroll"},c(function(){})}}a.arg_list=new Array,a.defintro_list=new Array,a.layout_style=null;var g=b.team_discuss_team_side;g||(a.participant_mgr=d,g=a.participant_mgr.own_group);var h=b.event_id,i=null,j=global_firebase_root_ref.child("event_related/game/"+h+"/deb_style");if(j.on("value",function(a){i=a.val(),e()},function(a){alert("fail to retrieve debate style"+a.code)}),"team_discussion"==b.room_type){f(),setTimeout(f,1e3);var k=document.getElementById("teamdiscuss_argument_container");k.onscroll=function(){f()}}a.$on("$destroy",function(){a.defintro_id_ref.off("child_added"),a.argument_id_ref.off("child_added"),a.argument_id_ref.off("child_removed"),j.off("value")})}]),angular.module("angularFireHangoutApp").controller("TeamdiscussRoomnameCtrl",["$scope","MixideaSetting",function(a,b){a.room_name=b.team_discuss_team_side}]);