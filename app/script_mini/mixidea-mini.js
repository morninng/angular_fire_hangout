"use strict";angular.module("angularFireHangoutApp",["ngAnimate","ui.router","firebase"]),angular.module("angularFireHangoutApp").run(["$state","MixideaSetting",function(a,b){function c(b,c){switch(b){case"main":switch(c){case"introduction":a.go("main.intro");break;case"preparation":a.go("main.preparation");break;case"debate":a.go("main.debate");break;case"reflection":a.go("main.reflection");break;case"complete":a.go("main.complete")}break;case"team_discussion":a.go("team_discussion")}}console.log("event id:"+b.event_id),console.log("user id : "+b.own_user_id),console.log("room type : "+b.room_type);var d=b.event_id,e=b.room_type,f=new Firebase(b.firebase_url),g=f.child("event_related/game/"+d+"/game_status");g.once("value",function(a){var b=a.val();c(e,b)},function(a){alert("event is corrupted, please confirm with mixidea administrator")})}]),angular.module("angularFireHangoutApp").config(["$stateProvider","MixideaSetting",function(a,b){a.state("main",{views:{RootView:{templateUrl:b.source_domain+"views/main/main_room_layout.html"}}}).state("main.intro",{views:{top_left:{templateUrl:b.source_domain+"views/common/title.html",controller:"TitleMgrCtrl"},container_second_top:{templateUrl:b.source_domain+"views/common/status-bar.html",controller:"StatusbarCtrl"},container_main_left_above_left_up:{templateUrl:b.source_domain+"views/main/static_video.html",controller:"StaticvideoCtrl"},container_main_left_above_right:{templateUrl:b.source_domain+"views/main/direction_intro.html"},container_main_left_below:{templateUrl:b.source_domain+"views/main/info_intro.html"},container_main_right:{templateUrl:b.source_domain+"views/main/participant_table.html",controller:"ParticipantTableParentCtrl"}}})}]),angular.module("angularFireHangoutApp").controller("MainCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("angularFireHangoutApp").controller("ParticipantTableParentCtrl",["$scope","MixideaSetting","ParticipantMgrService",function(a,b,c){new Firebase(b.firebase_url);a.change_shown=!1,a.debate_style=null,a.participant_mgr=c,a.show_change_style=function(){},a.change_style=function(){}}]),angular.module("angularFireHangoutApp").controller("ParticipantTableChildCtrl",["$scope","ParticipantMgrService","MixideaSetting",function(a,b,c){function d(a){var b=e.child("event_related/participants/"+c.event_id+"/game_role/"+a);b.set(null,function(a){a?console.log("cannot cancel"+a):console.log("cancel succed")})}var e=new Firebase(c.firebase_url);a.participant_mgr=b,a.own_user_id=c.own_user_id,a.join=function(a){var b=e.child("event_related/participants/"+c.event_id+"/game_role/"+a);b.transaction(function(a){return a?void alert("someone has already take this role"):c.own_user_id})},a.cancel=function(a){d(a)},a.decline=function(a){d(a)}}]),angular.module("angularFireHangoutApp").controller("StaticvideoCtrl",["$scope",function(a){var b=.8,c=300,d=String(c)+"px",e=c*b,f=String(e)+"px";a.video_canvas_dummy_layout={width:d,height:f}}]),angular.module("angularFireHangoutApp").controller("StatusbarCtrl",["$scope",function(a){a.status_intro="status_bar_element",a.status_prep="status_bar_element",a.status_debate="status_bar_element_selected",a.status_reflec="status_bar_element",a.status_complete="status_bar_element_last"}]),angular.module("angularFireHangoutApp").controller("TitleMgrCtrl",["$scope","MixideaSetting","$timeout",function(a,b,c){function d(){var b=a.data.motion.length,c=0;c=b>45?45:b>20?b:20;var d=String(c)+"em";a.dynamic_width={width:d}}a.under_edit=!1,a.data=new Object,a.data.motion="";var e=new Firebase(b.firebase_url),f=e.child("event_related/game/"+b.event_id+"/motion");f.on("value",function(b){c(function(){a.data.motion=b.val();var c=a.data.motion.length;0==c?(a.motion_sentence="motion_sentence_Red_xlarge",a.data.motion="input motion here",a.data.motion_exist=!1):60>c?(a.motion_sentence="motion_sentence_large",a.data.motion_exist=!0):100>c?(a.motion_sentence="motion_sentence_middle",a.data.motion_exist=!0):(a.motion_sentence="motion_sentence_small",a.data.motion_exist=!0)})},function(a){console.log("The read failed: "+a.code)}),a.on_motion_change=function(){d()},a.edit_start=function(){d(),a.data.motion_exist||(a.data.motion=""),a.under_edit=!0},a.save=function(){f.set(a.data.motion),a.under_edit=!1},a.cancel=function(){a.under_edit=!1}}]),angular.module("angularFireHangoutApp").factory("ParticipantMgrService",["MixideaSetting","$timeout",function(a,b){function c(a){j=new Object,n=0;for(var b in a)d(b),n++}function d(a){var b=g.child("users/user_basic/"+a);b.on("value",function(a){var b=a.val(),c=a.key();j[c]=b;var d=e(j);d==n&&f()},function(a){console.log("The read failed: "+a.code)})}function e(a){var b=0;for(var c in a)b++;return b}function f(){b(function(){var b=a.source_domain+"images/want_you.png";switch(k){case"NA":h.participant_obj={PM:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,team:"Gov",login:!1,css_style:"no_applicant"},LO:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,team:"Gov",login:!1,css_style:"no_applicant"}},h.audience_array.length=0;break;case"Asian":break;case"BP":break;default:return}for(var c in l){var d=!1;for(var e in i)if(c==i[e]){d=!0;break}if(!d){var f={applicant:!0,id:c,team:"Aud",login:!1,css_style:"logoff"};h.audience_array.push(f)}}for(var e in i)h.participant_obj[e].id=i[e],h.participant_obj[e].applicant=!0;for(var e in h.participant_obj){var g=h.participant_obj[e].id;j[g]&&(h.participant_obj[e].user_name=j[g].first_name,h.participant_obj[e].profile_pict=j[g].profile_pict,h.participant_obj[e].css_style="logoff"),m[g]&&(h.participant_obj[e].css_style="login",h.participant_obj[e].login=!0)}for(var n=0;n<h.audience_array.length;n++){var g=h.audience_array[n].id;j[g]&&(h.audience_array[n].user_name=j[g].first_name,h.audience_array[n].profile_pict=j[g].profile_pict,h.audience_array[n].applicant=!0,h.audience_array[n].css_style="logoff"),m[g]&&(h.audience_array[n].css_style="login")}})}var g=new Firebase(a.firebase_url),h=new Object;h.debate_style=null,h.participant_obj=new Object,h.own_group=null,h.participant_obj_bp_open=new Object,h.participant_obj_bp_close=new Object,h.audience_array=new Array,h.is_audience_yourself=!0;var i=new Object,j=new Object,k=null,l=new Object,m=new Object,n=0,o=(new Object,g.child("event_related/game/"+a.event_id+"/deb_style"));o.on("value",function(a){k=a.val(),b(function(){h.debate_style=k}),f()},function(a){console.log("The read failed: "+a.code)});var p=g.child("event_related/participants/"+a.event_id+"/full");p.on("value",function(a){var b=a.val();l=b?b:new Object,c(l)},function(a){console.log("The read failed: "+a.code)});var g=new Firebase(a.firebase_url),q=g.child("event_related/hangout_dynamic/"+a.event_id+"/mapping_data");q.on("value",function(a){var b=a.val();a.key();m=b?b:new Object,f()},function(a){console.log("The read failed: "+a.code)});var r=g.child("event_related/participants/"+a.event_id+"/game_role");return r.on("value",function(a){var b=a.val();i=b?b:new Object,f()},function(a){console.log("The read failed: "+a.code)}),h.get_hangout_id=function(){},h.get_user_info=function(){},h}]);