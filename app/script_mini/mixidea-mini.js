"use strict";function set_mapping_data(a,b){var c=new Firebase("https://mixidea.firebaseio.com/"),d=c.child("event_related/hangout_dynamic/"+global_event_id+"/mapping_data/"+global_own_user_id);d.set(b,function(a){a?alert("mapping failed"+a):console.log("hangout id "+b+" is set")})}function set_mapping_data(a,b){var c=new Firebase("https://mixidea.firebaseio.com/"),d=c.child("event_related/hangout_dynamic/"+global_event_id+"/mapping_data/"+global_own_user_id);d.set(b,function(a){a?alert("mapping failed"+a):console.log("hangout id "+b+" is set")}),d.onDisconnect().remove()}function set_mapping_data(a,b){var c=new Firebase("https://mixidea.firebaseio.com/"),d=c.child("event_related/hangout_dynamic/"+global_event_id+"/mapping_data/"+global_own_user_id);d.set(b,function(a){a?alert("mapping failed"+a):console.log("hangout id "+b+" is set")}),d.onDisconnect().remove()}function set_mapping_data(a,b){var c=new Firebase("https://mixidea.firebaseio.com/"),d=c.child("event_related/hangout_dynamic/"+global_event_id+"/mapping_data/"+global_own_user_id);d.set(b,function(a){a?alert("mapping failed"+a):console.log("hangout id "+b+" is set")}),d.onDisconnect().remove()}angular.module("angularFireHangoutApp",["ngAnimate","ui.router","firebase","ngSanitize"]),angular.module("angularFireHangoutApp").run(["$state","MixideaSetting",function(a,b){function c(b,c){switch(b){case"main":switch(c){case"introduction":a.go("main.introduction");break;case"preparation":a.go("main.preparation");break;case"debate":a.go("main.debate");break;case"reflection":a.go("main.reflection");break;case"complete":a.go("main.complete")}break;case"team_discussion":a.go("team_discussion.room")}}console.log("event id:"+b.event_id),console.log("user id : "+b.own_user_id),console.log("room type : "+b.room_type);var d=b.event_id,e=b.room_type;if("main"==e){var f=new Firebase(b.firebase_url),g=f.child("event_related/game/"+d+"/game_status");g.once("value",function(a){var b=a.val();c(e,b)},function(a){alert("event is corrupted, please confirm with mixidea administrator")})}else"team_discussion"==e&&(console.log("team_discuss_team_side : "+b.team_discuss_team_side),console.log("team_discuss_own_team : "+b.team_discuss_own_team),a.go("team_discussion.room"))}]),angular.module("angularFireHangoutApp").config(["$stateProvider","MixideaSetting",function(a,b){a.state("main",{views:{RootView:{templateUrl:b.source_domain+"views/main/layout_main_room.html",controller:"MainlayoutSizeadjustCtrl"}}}).state("main.introduction",{views:{top_left:{templateUrl:b.source_domain+"views/common/title.html",controller:"TitleMgrCtrl"},container_second_top:{templateUrl:b.source_domain+"views/common/status-bar.html",controller:"StatusbarCtrl"},container_main_left_above_left_up:{templateUrl:b.source_domain+"views/main/video_static.html",controller:"StaticvideoCtrl"},container_main_left_above_right:{templateUrl:b.source_domain+"views/main/direction_intro.html",controller:"StatusUpdateCtrl"},container_main_left_below:{templateUrl:b.source_domain+"views/main/info_intro.html"},container_main_right:{templateUrl:b.source_domain+"views/main/participant_table.html",controller:"ParticipantTableParentCtrl"}}}).state("main.preparation",{views:{top_left:{templateUrl:b.source_domain+"views/common/title.html",controller:"TitleMgrCtrl"},container_second_top:{templateUrl:b.source_domain+"views/common/status-bar.html",controller:"StatusbarCtrl"},container_main_left_above_left_up:{templateUrl:b.source_domain+"views/main/video_static.html",controller:"StaticvideoCtrl"},container_main_left_above_right:{templateUrl:b.source_domain+"views/main/direction_prep.html",controller:"StatusUpdateCtrl"},container_main_left_below:{templateUrl:b.source_domain+"views/main/info_prep.html",controller:"LinkTeamdiscussCtrl"},container_main_right:{templateUrl:b.source_domain+"views/main/participant_table.html",controller:"ParticipantTableParentCtrl"}}}).state("main.debate",{views:{top_left:{templateUrl:b.source_domain+"views/common/title_fix.html",controller:"TitleMgrCtrl"},top_right:{templateUrl:b.source_domain+"views/main/direction_debate.html",controller:"StatusUpdateCtrl"},container_second_top:{templateUrl:b.source_domain+"views/common/status-bar.html",controller:"StatusbarCtrl"},container_main_left_above_left_up:{templateUrl:b.source_domain+"views/main/video_debate.html",controller:"VideodebateCtrl"}}}).state("main.reflection",{views:{top_left:{templateUrl:b.source_domain+"views/common/title_fix.html",controller:"TitleMgrCtrl"},top_right:{templateUrl:b.source_domain+"views/main/direction_reflection.html",controller:"StatusUpdateCtrl"},container_second_top:{templateUrl:b.source_domain+"views/common/status-bar.html",controller:"StatusbarCtrl"},container_main_right:{templateUrl:b.source_domain+"views/main/layout_reflec_tab.html",controller:"ReflecTabCtrl"}}}).state("main.reflection.write_article",{views:{reflec_tab_first:{templateUrl:b.source_domain+"views/main/url_sharing.html",controller:"UrlSharingCtrl"},reflec_tab_second:{templateUrl:b.source_domain+"views/main/article_writing.html",controller:"ArticleWritingCtrl"}}}).state("main.reflection.own_note",{views:{reflec_tab_first:{templateUrl:b.source_domain+"views/main/own_note.html"}}}).state("main.complete",{views:{top_left:{templateUrl:b.source_domain+"views/common/title_fix.html",controller:"TitleMgrCtrl"},top_right:{templateUrl:b.source_domain+"views/main/direction_complete.html",controller:"StatusUpdateCtrl"},container_second_top:{templateUrl:b.source_domain+"views/common/status-bar.html",controller:"StatusbarCtrl"}}}).state("team_discussion",{views:{RootView:{templateUrl:b.source_domain+"views/team_discussion/t_room_layout.html"}}}).state("team_discussion.room",{views:{team_discuss_first:{templateUrl:b.source_domain+"views/team_discussion/room_name.html",controller:"TeamdiscussRoomnameCtrl"},second_left:{templateUrl:b.source_domain+"views/team_discussion/t_room_motion.html",controller:"TitleMgrCtrl"},second_middle:{templateUrl:b.source_domain+"views/team_discussion/t_room_link_main_room.html",controller:"LinkMainroomCtrl"},second_right:{templateUrl:b.source_domain+"views/team_discussion/t_room_count_prep_time.html",controller:"CountPreptimeCtrl"},container_main:{templateUrl:b.source_domain+"views/team_discussion/t_room_arguments.html",controller:"TeamdiscussArgumentsCtrl"}}})}]),angular.module("angularFireHangoutApp").controller("ArticleWritingCtrl",["$scope","ParticipantMgrService","MixideaSetting","$timeout",function(a,b,c,d){function e(){if(a.argument_id_data){switch(a.debate_style){case"NA":a.NA_Gov_def_intro=Object.keys(a.argument_id_data.NA.Gov.def_intro)[0],a.NA_Gov_arguments.length=0;for(var b=Object.keys(a.argument_id_data.NA.Gov.arguments),c=0;c<b.length;c++){var e={arg_id:b[c],event_id:f,team:"Gov",deb_style:"NA"};a.NA_Gov_arguments.push(e)}a.NA_Opp_arguments.length=0;for(var g=Object.keys(a.argument_id_data.NA.Opp.arguments),c=0;c<g.length;c++){var e={arg_id:g[c],event_id:f,team:"Opp",deb_style:"NA"};a.NA_Opp_arguments.push(e)}break;case"Asian":break;case"BP":}d(function(){})}}a.participant_mgr=b,a.debate_style=a.participant_mgr.debate_style,a.argument_id_data=null,a.NA_Gov_def_intro=null,a.NA_Gov_arguments=[],a.NA_Opp_arguments=[];var f=c.event_id,g=new Firebase(c.firebase_url),h="event_related/Article_Context/"+f+"/identifier/",i=g.child(h);i.on("value",function(b){a.argument_id_data=b.val(),e(),a.$watch("participant_mgr.debate_style",function(b,c){a.debate_style=b,e()})}),a.add_argument=function(a,b){var c="event_related/Article_Context/"+f+"/identifier/"+a+"/"+b+"/arguments",d=g.child(c),e={dummy:!0};d.push(e)}}]),angular.module("angularFireHangoutApp").controller("CountPreptimeCtrl",["$scope","MixideaSetting","$timeout",function(a,b,c){a.prep_time="start preparation";var d=null,e=new Firebase("https://mixidea.firebaseio.com/"),f=e.child("event_related/hangout_dynamic/"+b.event_id+"/preparation_timer/");f.on("value",function(a){d=a.val()},function(){console.log("fail to load timer data")});setInterval(function(){if(d){var b=Date.now(),e=b-d;if(!(0>e)){var f=e/1e3,g=f/60/60;g=Math.floor(g);var h=(f-60*g*60)/60;h=Math.floor(h),f=f-60*g*60-60*h,f=Math.floor(f),f=("0"+f).slice(-2),h=("0"+h).slice(-2),c(function(){a.prep_time=h+":"+f+" has passed"})}}},1e3)}]),angular.module("angularFireHangoutApp").controller("LinkTeamdiscussCtrl",["$scope","ParticipantMgrService","MixideaSetting","$timeout",function(a,b,c,d){function e(){if(0!=f.length){a.team_hangout_array.length=0;var b="?gid=",e=c.hangout_appid,g="&gd=",h=c.own_user_id,i=c.event_id,j="team_discussion",k=a.participant_mgr.own_group;if("Audience"==a.participant_mgr.is_audience_or_debater)for(var l=0;l<a.participant_mgr.all_group_name_array.length;l++){var m=new Object;m.name=a.participant_mgr.all_group_name_array[l];var n=a.participant_mgr.all_group_name_array[l],o=f[l];m.hangout_url=o+b+e+g+h+"^"+i+"^"+j+"^"+n+"^"+k,a.team_hangout_array.push(m)}else{var m=new Object;m.name=a.participant_mgr.own_group;var n=a.participant_mgr.own_group,o=f[a.participant_mgr.own_group_id];m.hangout_url=o+b+e+g+h+"^"+i+"^"+j+"^"+n+"^"+k,a.team_hangout_array.push(m)}d(function(){})}}a.aaa="name",a.participant_mgr=b,a.team_hangout_array=new Array;var f=(new Object,new Array);a.$watch("participant_mgr.own_group",function(a,b){e()});var g=new Firebase(c.firebase_url),h=g.child("event_related/game_hangout_obj_list/"+c.event_id+"/team_discussion");h.on("value",function(a){f=a.val(),e()},function(a){console.log("The read failed: "+a.code)})}]),angular.module("angularFireHangoutApp").controller("MainlayoutSizeadjustCtrl",["$scope","StatusMgrService","$timeout",function(a,b,c){a.game_status_service=b,a.$watch("game_status_service.game_status",function(b,d){console.log("status:"+b),c(function(){switch(b){case"introduction":a.top_right_width={width:"0px"},a.main_left_above_left_width={width:"300px"},a.main_left_above_right_width={width:"250px"},a.main_left_below_width={width:"550px"},a.main_right_width={width:"550px"};break;case"preparation":a.top_right_width={width:"0px"},a.main_left_above_left_width={width:"300px"},a.main_left_above_right_width={width:"250px"},a.main_left_below_width={width:"550px"},a.main_right_width={width:"550px"};break;case"debate":a.top_right_width={width:"250px"},a.main_left_above_left_width={width:"300px"},a.main_left_above_right_width={width:"0px"},a.main_left_below_width={width:"0px"},a.main_width={width:"1000px"},a.main_right_width={width:"700px"};break;case"reflection":a.top_right_width={width:"250px"},a.main_left_above_left_width={width:"0px"},a.main_left_above_right_width={width:"0px"},a.main_left_below_width={width:"0px"},a.main_width={width:"100%"},a.main_right_width={width:"100%"};break;case"complete":a.top_right_width={width:"250px"}}})})}]),angular.module("angularFireHangoutApp").controller("ParticipantTableParentCtrl",["$scope","MixideaSetting","ParticipantMgrService",function(a,b,c){function d(){a.change_shown=!1}a.participant_mgr=c;var e=new Firebase(b.firebase_url);a.change_shown=!1,a.participant_mgr=c,a.show_change_style=function(){a.change_shown=!0},a.change_style=function(){a.change_shown=!1;var c=a.participant_mgr.debate_style,d=e.child("event_related/game/"+b.event_id+"/deb_style");d.set(c),console.log(c)},a.mouseout_change_style=function(){d()},a.cancel_change_style=function(){d()}}]),angular.module("angularFireHangoutApp").controller("ParticipantTableChildCtrl",["$scope","ParticipantMgrService","MixideaSetting",function(a,b,c){function d(b){var d=e.child("event_related/participants/"+c.event_id+"/game_role/"+a.participant_mgr.debate_style+"/"+b);d.set(null,function(a){a?console.log("cannot cancel"+a):console.log("cancel succed")})}var e=new Firebase(c.firebase_url);a.participant_mgr=b,a.own_user_id=c.own_user_id,a.join=function(b){var d=e.child("event_related/participants/"+c.event_id+"/game_role/"+a.participant_mgr.debate_style+"/"+b);d.transaction(function(a){return a?void alert("someone has already take this role"):c.own_user_id})},a.cancel=function(a){d(a)},a.decline=function(a){d(a)}}]),angular.module("angularFireHangoutApp").controller("ReflecTabCtrl",["$scope",function(a){}]),angular.module("angularFireHangoutApp").controller("StaticvideoCtrl",["$scope",function(a){var b=.8,c=300,d=String(c)+"px",e=c*b,f=String(e)+"px";a.video_canvas_dummy_layout={width:d,height:f}}]),angular.module("angularFireHangoutApp").controller("StatusUpdateCtrl",["$scope","MixideaSetting",function(a,b){function c(){var a=Date.now(),c=new Firebase("https://mixidea.firebaseio.com/"),d=c.child("event_related/hangout_dynamic/"+b.event_id+"/preparation_timer/");d.set(a,function(a){a?console.log("setting time failed"+a):console.log("set time succeed")})}var d=new Firebase(b.firebase_url),e=d.child("event_related/game/"+b.event_id+"/game_status");a.update_status=function(a){"preparation"==a&&c(),console.log(a),e.set(a,function(a){a?console.log("saving status failed"+a):console.log("status is updated")})}}]),angular.module("angularFireHangoutApp").controller("StatusbarCtrl",["$scope","StatusMgrService","$timeout",function(a,b,c){a.status_intro="status_bar_element",a.status_prep="status_bar_element",a.status_debate="status_bar_element",a.status_reflec="status_bar_element",a.status_complete="status_bar_element_last",a.game_status_service=b,a.$watch("game_status_service.game_status",function(b,d){console.log("status:"+b),a.status_intro="status_bar_element",a.status_prep="status_bar_element",a.status_debate="status_bar_element",a.status_reflec="status_bar_element",a.status_complete="status_bar_element_last",c(function(){switch(b){case"introduction":a.status_intro="status_bar_element_selected";break;case"preparation":a.status_prep="status_bar_element_selected";break;case"debate":a.status_debate="status_bar_element_selected";break;case"reflection":a.status_reflec="status_bar_element_selected";break;case"complete":a.status_complete="status_bar_element_selected"}})})}]),angular.module("angularFireHangoutApp").controller("TitleMgrCtrl",["$scope","MixideaSetting","$timeout",function(a,b,c){function d(){var b=a.data.motion.length,c=0;c=b>45?45:b>20?b:20;var d=String(c)+"em";a.dynamic_width={width:d}}a.under_edit=!1,a.data=new Object,a.data.motion="";var e=new Firebase(b.firebase_url),f=e.child("event_related/game/"+b.event_id+"/motion");f.on("value",function(b){c(function(){if(a.data.motion=b.val(),!a.data.motion)return a.motion_sentence="motion_sentence_Red_xlarge",a.data.motion="input motion here",void(a.data.motion_exist=!1);var c=a.data.motion.length;0==c&&(a.motion_sentence="motion_sentence_Red_xlarge",a.data.motion="input motion here",a.data.motion_exist=!1),60>c?(a.motion_sentence="motion_sentence_large",a.data.motion_exist=!0):100>c?(a.motion_sentence="motion_sentence_middle",a.data.motion_exist=!0):(a.motion_sentence="motion_sentence_small",a.data.motion_exist=!0)})},function(a){console.log("The read failed: "+a.code)}),a.on_motion_change=function(){d()},a.edit_start=function(){d(),a.data.motion_exist||(a.data.motion=""),a.under_edit=!0},a.save=function(){f.set(a.data.motion),a.under_edit=!1},a.cancel=function(){a.under_edit=!1}}]),angular.module("angularFireHangoutApp").controller("UrlSharingCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("angularFireHangoutApp").controller("VideodebateCtrl",["$scope","MixideaSetting","ParticipantMgrService","$timeout","SoundPlayService","RecognitionService","UtilService","RecordingService",function(a,b,c,d,e,f,g,h){function i(){d(function(){a.poi_speaker_obj.id?(o(a.poi_speaker_obj.id,"poi"),a.status="poi"):a.speaker_obj.id?("break"==a.status&&j(),o(a.speaker_obj.id,"speech"),a.status="speech"):("break"!=a.status&&k(),o(null,"break"),a.status="break")})}function j(){l()}function k(){m()}function l(){a.timer_value="speech start",z||(A=0,z=setInterval(function(){n()},1e3))}function m(){A=0,d(function(){a.timer_value=null}),clearInterval(z),z=null}function n(){A++;var b=A%60,c=(A-b)/60,e=b,f=c+"min "+e+"sec";1==c&&0==e||6==c&&0==e?console.log("one minutes"):6==c&&0==e?console.log("two minutes"):7==c&&0==e?console.log("seven minutes"):7==c&&30==e&&console.log("seven and half minutes"),d(function(){a.timer_value=f})}function o(c,d){c==b.own_user_id?(f.start(d,y,a.speech_start_time),h.record_start_api(d,y,a.speech_start_time)):c?(f.stop(),h.record_finish_api("other",y,a.speech_start_time)):(f.stop(),h.record_finish_api("break",y,a.speech_start_time)),a.current_speaker==c}a.participant_mgr=c,a.status="break",a.speaker_obj=new Object,a.poi_speaker_obj=new Object,a.poi_candidate_userobj_array=new Array,a.timer_value=null,a.speech_start_time=0;var p=new Firebase(b.firebase_url),q=p.child("event_related/hangout_dynamic/"+b.event_id+"/video_status"),r=q.child("speaker"),s=q.child("speaker/"+b.own_user_id),t=q.child("poi"),u=q.child("poi/candidate"),v=q.child("poi/candidate/"+b.own_user_id),w=q.child("poi/taken"),x=q.child("poi/taken/"+b.own_user_id),y=null;a.speech_start=function(c){var d=a.participant_mgr.own_side,f=a.participant_mgr.own_first_name,h=g.get_full_role_name(c),i=Date.now(),j={role:c,name:f,side:d,full_role_name:h,speech_start_time:i},k=new Object;k[b.own_user_id]=j,r.transaction(function(a){return a?void 0:k}),s.onDisconnect().set(null),e.SpeechStart()},r.on("value",function(b){var c=b.val();if(c){var d=new Object;for(var e in c){var f=e;a.speaker_obj.id=f;var d=c[f];a.speaker_obj.name=d.name,a.speaker_obj.role=d.role,y=d.role,a.speaker_obj.side=d.side,a.speaker_obj.full_role_name=d.full_role_name,a.speech_start_time=d.speech_start_time}}else for(var e in a.speaker_obj)delete a.speaker_obj[e];i()},function(a){console.log("fail while to retrieve speaker obj"+a)}),a.complete_speech=function(){q.set(null)},a.poi=function(){var b=a.participant_mgr.own_group;v.set(b),v.onDisconnect().set(null),x.onDisconnect().set(null),e.Poi()},u.on("value",function(b){var c=b.val();a.poi_candidate_userobj_array.length=0,d(function(){for(var b in c){var d={id:b,group:c[b]};a.poi_candidate_userobj_array.push(d)}})}),a.finish_poi=function(){t.set(null),e.PoiFinish()},a.cancel_poi=function(){v.set(null)},a.take_poi=function(a,b){var c=new Object;c[a]=b,w.transaction(function(a){return a?void 0:c}),u.set(null),e.Taken()},w.on("value",function(b){var c=b.val(),d=null,e=null;for(var f in c)d=f,e=c[f];if(d)a.poi_speaker_obj.id=d,a.poi_speaker_obj.speaker_group="Poi from "+e;else for(var f in a.poi_speaker_obj)delete a.poi_speaker_obj[f];i()});var z=null,A=0;a.timer_value=null,a.current_speaker=null}]);var global_own_user_id=null,global_event_id=null,global_room_type=null,global_own_hangout_id=null,global_team_side=null,global_own_team_side=null;!function(){var a=gadgets.views.getParams().appData,b=a.split("^");global_own_user_id=b[0],global_event_id=b[1],global_room_type=b[2],"team_discussion"==global_room_type&&(global_team_side=b[3],global_own_team_side=b[4]),gapi.hangout.onApiReady.add(function(a){a.isApiReady&&(global_own_hangout_id=gapi.hangout.getLocalParticipantId(),set_mapping_data(global_own_user_id,global_own_hangout_id))})}(),angular.module("angularFireHangoutApp").constant("MixideaSetting",{firebase_url:"https://mixidea.firebaseio.com/",source_domain:"https://s3.amazonaws.com/mixideahangoutsource/angular_fire_hangout/app/",own_user_id:global_own_user_id,event_id:global_event_id,room_type:global_room_type,hangout_appid:"211272797315",team_discuss_team_side:global_team_side,team_discuss_own_team:global_own_team_side,recording_domain:"https://recording.mixidea.org:3000/"});var global_own_user_id=null,global_event_id=null,global_room_type=null,global_team_side=null,global_own_team_side=null;!function(){global_event_id="-KC_6f1izVFTY9sJt_rM",global_own_user_id="facebook:1520978701540732",global_room_type="main","team_discussion"==global_room_type&&(global_team_side="Prop",global_own_team_side="Prop");var a="11111111111";set_mapping_data(global_own_user_id,a)}(),angular.module("angularFireHangoutApp").constant("MixideaSetting",{firebase_url:"https://mixidea.firebaseio.com/",source_domain:"https://s3.amazonaws.com/mixideahangoutsource/angular_fire_hangout/app/",own_user_id:global_own_user_id,event_id:global_event_id,room_type:global_room_type,hangout_appid:"211272797315",team_discuss_team_side:global_team_side,team_discuss_own_team:global_own_team_side,recording_domain:"https://recording.mixidea.org:3000/"});var global_own_user_id=null,global_event_id=null,global_room_type=null,global_team_side=null,global_own_team_side=null;!function(){global_event_id="-KC_6f1izVFTY9sJt_rM",global_own_user_id="facebook:997119893702319",global_room_type="main","team_discussion"==global_room_type&&(global_team_side="Prop",global_own_team_side="Prop");var a="2222222222";set_mapping_data(global_own_user_id,a)}(),angular.module("angularFireHangoutApp").constant("MixideaSetting",{firebase_url:"https://mixidea.firebaseio.com/",source_domain:"https://s3.amazonaws.com/mixideahangoutsource/angular_fire_hangout/app/",own_user_id:global_own_user_id,event_id:global_event_id,room_type:global_room_type,hangout_appid:"211272797315",team_discuss_team_side:global_team_side,team_discuss_own_team:global_own_team_side,recording_domain:"https://recording.mixidea.org:3000/"});var global_own_user_id=null,global_event_id=null,global_room_type=null,global_own_hangout_id=null,global_team_side=null,global_own_team_side=null;!function(){global_event_id="-KC_6f1izVFTY9sJt_rM",global_own_user_id="facebook:1520978701540732",global_room_type="main","team_discussion"==global_room_type&&(global_team_side="Gov",global_own_team_side="Opp");var a="BBCCBBBBB";set_mapping_data(global_own_user_id,a)}(),angular.module("angularFireHangoutApp").constant("MixideaSetting",{firebase_url:"https://mixidea.firebaseio.com/",source_domain:"/",own_user_id:global_own_user_id,event_id:global_event_id,room_type:global_room_type,hangout_appid:"211272797315",team_discuss_team_side:global_team_side,team_discuss_own_team:global_own_team_side,recording_domain:"https://recording.mixidea.org:3000/"}),angular.module("angularFireHangoutApp").directive("oneArgument",["$timeout","MixideaSetting","ParticipantMgrService","$sce","UtilService",function(a,b,c,d,e){return{templateUrl:d.trustAsResourceUrl(b.source_domain+"views/directive/oneArgument_directive.html"),restrict:"E",replace:!0,scope:{argument_id_obj:"=argId"},link:function(d,f,g){function h(){a(function(){var a=d.element[0].getElementsByClassName("title_p"),b=a[0].offsetHeight;b+=5;var c=String(b)+"px";d.title_height={height:c}})}function i(){a(function(){var a=d.element[0].getElementsByClassName("MainArg_Content"),b=a[0].offsetHeight;b+=15,b=String(b)+"px",d.textearea_height={height:b}})}console.log("link is called"),console.log(d.argument_id_obj);var j=d.argument_id_obj.arg_id,k=d.argument_id_obj.event_id,l=d.argument_id_obj.deb_style,m=d.argument_id_obj.team;d.element=f,d.participant_mgr=c,d.others_writing_title=!1,d.others_writing_content=!1;var n=new Firebase(b.firebase_url),o="event_related/Article_Context/"+k+"/context/"+j,p=n.child(o),q=p.child("title");q.on("value",function(b){a(function(){d.title=b.val(),h()})}),d.change_title=function(){d.title;d.title=d.title.replace(/(\r\n|\n|\r)/gm,""),q.set(d.title)};var r=p.child("content");r.on("value",function(b){a(function(){d.content=b.val(),d.content_div=e.add_linebreak_html(d.content),i()})}),d.change_content=function(){var a=d.content;r.set(a)};var n=new Firebase(b.firebase_url),s="event_related/Article_Context/"+k+"/focused/"+j,t=n.child(s),u=t.child("title");u.on("value",function(c){a(function(){var a=c.val();d.others_writing_title=!1;for(var e in a)e!=b.own_user_id&&(d.others_writing_title=!0,d.others_id_title=e);d.others_writing_title?(d.show_hide_title_textarea="child_hide",d.show_hide_title_content="child_show"):(d.show_hide_title_textarea="child_show",d.show_hide_title_content="child_hide")})});var v=t.child("title/"+b.own_user_id);d.title_focused=function(){v.set(!0)},d.title_unfocused=function(){v.set(null)},v.onDisconnect().remove();var w=t.child("content");w.on("value",function(c){a(function(){var a=c.val();d.others_writing_content=!1;for(var e in a)e!=b.own_user_id&&(d.others_writing_content=!0,d.others_id_content=e);d.others_writing_content?(d.show_hide_content_textarea="child_hide",d.show_hide_content_content="child_show"):(d.show_hide_content_textarea="child_show",d.show_hide_content_content="child_hide")})});var x=t.child("content/"+b.own_user_id);d.content_focused=function(){x.set(!0),console.log("content focused")},d.content_unfocused=function(){console.log("content unfocused"),x.set(null)},x.onDisconnect().remove();var y="event_related/Article_Context/"+k+"/identifier/"+l+"/"+m+"/arguments/"+j,z=n.child(y);d.remove_argument=function(){console.log("remove"+j),z.set(null)}}}}]),angular.module("angularFireHangoutApp").directive("oneDefintro",["$timeout","MixideaSetting","ParticipantMgrService","$sce","UtilService",function(a,b,c,d,e){return{templateUrl:d.trustAsResourceUrl(b.source_domain+"views/directive/oneDefintro_directive.html"),restrict:"E",scope:{argument_id_obj:"=argId"},link:function(d,f,g){var h=d.argument_id_obj.arg_id,i=d.argument_id_obj.event_id;d.argument_id_obj.deb_style,d.argument_id_obj.team;d.element=f,d.participant_mgr=c,d.others_writing=!1;var j=new Firebase(b.firebase_url),k="event_related/Article_Context/"+i+"/context/"+h,l=j.child(k),m=l.child("content");m.on("value",function(b){a(function(){d.content=b.val(),d.content_div=e.add_linebreak_html(d.content)})}),d.change_content=function(){var a=d.content;m.set(a)};var j=new Firebase(b.firebase_url),n="event_related/Article_Context/"+i+"/focused/"+h,o=j.child(n),p=o.child("content");p.on("value",function(c){a(function(){var a=c.val();d.others_writing=!1;for(var e in a)e!=b.own_user_id&&(d.others_writing=!0,d.others_id=e);d.others_writing?(d.show_hide_textarea="child_hide",d.show_hide_content="child_show"):(d.show_hide_textarea="child_show",d.show_hide_content="child_hide")})});var q=o.child("content/"+b.own_user_id);d.content_focused=function(){q.set(!0),console.log("content focused")},d.content_unfocused=function(){console.log("content unfocused"),q.set(null)},q.onDisconnect().remove()}}}]),angular.module("angularFireHangoutApp").directive("writingArgument",["$timeout","MixideaSetting","ParticipantMgrService","$sce","UtilService",function(a,b,c,d,e){return{templateUrl:d.trustAsResourceUrl(b.source_domain+"views/directive/writingArgument_directive.html"),restrict:"E",replace:!0,scope:{argument_id_obj:"=argId"},link:function(d,f,g){function h(){a(function(){var a=d.element[0].getElementsByClassName("title_p"),b=a[0].offsetHeight;b+=5;var c=String(b)+"px";d.title_height={height:c}})}function i(){a(function(){var a=d.element[0].getElementsByClassName("MainArg_Content"),b=a[0].offsetHeight;b+=15,b=String(b)+"px",d.textearea_height={height:b}})}console.log("link is called"),console.log(d.argument_id_obj);var j=d.argument_id_obj.arg_id,k=d.argument_id_obj.event_id,l=d.argument_id_obj.deb_style,m=d.argument_id_obj.team;d.element=f,d.participant_mgr=c,d.others_writing_title=!1,d.others_writing_content=!1;var n=new Firebase(b.firebase_url),o="event_related/Article_Context/"+k+"/context/"+j,p=n.child(o),q=p.child("title");q.on("value",function(b){a(function(){d.title=b.val(),h()})}),d.change_title=function(){d.title;d.title=d.title.replace(/(\r\n|\n|\r)/gm,""),q.set(d.title)},d.edit_title=function(){v.set(!0)};var r=p.child("content");r.on("value",function(b){a(function(){d.content=b.val(),d.content_div=e.add_linebreak_html(d.content),i()})}),d.change_content=function(){var a=d.content;r.set(a)},d.edit_content=function(){x.set(!0)};var n=new Firebase(b.firebase_url),s="event_related/Article_Context/"+k+"/focused/"+j,t=n.child(s),u=t.child("title");u.on("value",function(c){a(function(){var a=c.val();d.writing_title_bymyself=!1,d.writing_title_byothers=!1;for(var e in a)e==b.own_user_id?d.writing_title_bymyself=!0:(d.writing_title_byothers=!0,d.others_id_title=e);d.writing_title_bymyself?(d.show_hide_title_textarea="child_show",d.show_hide_title_content="child_hide"):(d.show_hide_title_textarea="child_hide",d.show_hide_title_content="child_show")})});var v=t.child("title/"+b.own_user_id);d.title_unfocused=function(){v.set(null),console.log("title unfocused")},d.title_save=function(){v.set(null),console.log("save")},v.onDisconnect().remove();var w=t.child("content");w.on("value",function(c){a(function(){var a=c.val();d.writing_content_byothers=!1,d.writing_content_bymyself=!1;for(var e in a)e!=b.own_user_id?(d.writing_content_byothers=!0,d.others_id_content=e):d.writing_content_bymyself=!0;d.writing_content_bymyself?(d.show_hide_content_textarea="child_show",d.show_hide_content_content="child_hide"):(d.show_hide_content_textarea="child_hide",d.show_hide_content_content="child_show")})});var x=t.child("content/"+b.own_user_id);d.content_unfocused=function(){x.set(null),console.log("content unfocused")},x.onDisconnect().remove(),d.save_content=function(){x.set(null)};var y="event_related/Article_Context/"+k+"/identifier/"+l+"/"+m+"/arguments/"+j,z=n.child(y);d.remove_argument=function(){console.log("remove"+j),z.set(null)}}}}]),angular.module("angularFireHangoutApp").factory("ParticipantMgrService",["MixideaSetting","$timeout",function(a,b){function c(a){for(b in i.user_object_data)delete i.user_object_data[b];o=0;for(var b in a)d(b),o++}function d(b){var c=j.child("users/user_basic/"+b);c.on("value",function(b){var c=b.val(),d=b.key();i.user_object_data[d]=c;var f=h(i.user_object_data);d==a.own_user_id&&(i.own_first_name=c.first_name,i.own_last_name=c.last_name),f==o&&e()},function(a){console.log("The read failed: "+a.code)})}function e(){b(function(){var b=a.source_domain+"images/want_you.png";switch(l){case"NA":i.participant_obj={PM:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"Gov",group_id:0,side:"left",login:!1,css_style:"participant_box_default"},LO:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"Opp",group_id:1,side:"right",login:!1,css_style:"participant_box_default"},MG:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"Gov",group_id:0,side:"left",login:!1,css_style:"participant_box_default"},MO:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"Opp",group_id:1,side:"right",login:!1,css_style:"participant_box_default"},PMR:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"Gov",group_id:0,side:"left",login:!1,css_style:"participant_box_default"},LOR:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"Opp",group_id:1,side:"right",login:!1,css_style:"participant_box_default"}};var c=k.NA;c||(c=new Object),i.audience_array.length=0;break;case"Asian":i.participant_obj={PM:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"Prop",group_id:0,side:"left",login:!1,css_style:"participant_box_default"},LO:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"Opp",side:"right",group_id:1,login:!1,css_style:"participant_box_default"},DPM:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"Prop",group_id:0,side:"left",login:!1,css_style:"participant_box_default"},DLO:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"Opp",group_id:1,side:"right",login:!1,css_style:"participant_box_default"},WG:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"Prop",group_id:0,side:"left",login:!1,css_style:"participant_box_default"},WO:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"Opp",group_id:1,side:"right",login:!1,css_style:"participant_box_default"},PMR:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"Prop",group_id:0,side:"left",login:!1,css_style:"participant_box_default"},LOR:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"Opp",group_id:1,side:"right",login:!1,css_style:"participant_box_default"}};var c=k.Asian;c||(c=new Object),i.audience_array.length=0;break;case"BP":
i.participant_obj={PM:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"OG",group_id:0,side:"left",part:"Opening",login:!1,css_style:"participant_box_default"},LO:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"OO",group_id:1,side:"right",part:"Opening",login:!1,css_style:"participant_box_default"},DPM:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"OG",group_id:0,side:"left",part:"Opening",login:!1,css_style:"participant_box_default"},DLO:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"OO",group_id:1,side:"right",part:"Opening",login:!1,css_style:"participant_box_default"},MG:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"CG",group_id:2,side:"left",part:"Closing",login:!1,css_style:"participant_box_default"},MO:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"CO",group_id:3,side:"right",part:"Closing",login:!1,css_style:"participant_box_default"},GW:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"CG",group_id:2,side:"left",part:"Closing",login:!1,css_style:"participant_box_default"},OW:{user_name:"no applilcant",profile_pict:b,applicant:!1,id:null,group:"CO",group_id:3,side:"right",part:"Closing",login:!1,css_style:"participant_box_default"}};var c=k.BP;c||(c=new Object),i.audience_array.length=0;break;default:return}for(var d in m){var e=!1;for(var h in c)if(d==c[h]){e=!0;break}if(!e){var j={applicant:!0,id:d,group:"Aud",login:!1,css_style:"participant_box_default"};i.audience_array.push(j)}}for(var h in c)i.participant_obj[h].id=c[h],i.participant_obj[h].applicant=!0;for(var h in i.participant_obj){var o=i.participant_obj[h].id;i.user_object_data[o]&&(i.participant_obj[h].user_name=i.user_object_data[o].first_name,i.participant_obj[h].profile_pict=i.user_object_data[o].profile_pict,i.participant_obj[h].css_style="participant_box_logoff"),n[o]&&(i.participant_obj[h].css_style="participant_box_login",i.participant_obj[h].login=!0)}for(var p=0;p<i.audience_array.length;p++){var o=i.audience_array[p].id;i.user_object_data[o]&&(i.audience_array[p].user_name=i.user_object_data[o].first_name,i.audience_array[p].profile_pict=i.user_object_data[o].profile_pict,i.audience_array[p].applicant=!0,i.audience_array[p].css_style="participant_box_logoff"),n[o]&&(i.audience_array[p].css_style="participant_box_login")}"BP"==l&&f(),console.log("participant obj"),console.log(i.participant_obj),console.log("audience array"),console.log(i.audience_array),g()})}function f(){for(var a in i.participant_obj_bp_open)delete i.participant_obj_bp_open[a];for(var a in i.participant_obj_bp_close)delete i.participant_obj_bp_close[a];for(var b in i.participant_obj)"Opening"==i.participant_obj[b].part&&(i.participant_obj_bp_open[b]=i.participant_obj[b]),"Closing"==i.participant_obj[b].part&&(i.participant_obj_bp_close[b]=i.participant_obj[b]);console.log("participant_obj_bp_open"),console.log(i.participant_obj_bp_open),console.log("participant_obj_bp_close"),console.log(i.participant_obj_bp_close)}function g(){switch(l){case"NA":i.all_group_name_array=["Gov","Opp"],i.all_group_id=[0,1];break;case"Asian":i.all_group_name_array=["Prop","Opp"],i.all_group_id=[0,1];break;case"BP":i.all_group_name_array=["OG","OO","CG","CO"],i.all_group_id=[0,1,2,3]}i.own_role_array.length=0,i.own_group="Audience",i.is_audience_or_debater="Audience",i.own_side="Audience",i.own_group_id=null;for(var b in i.participant_obj)i.participant_obj[b].id==a.own_user_id&&(i.own_role_array.push(b),i.own_group=i.participant_obj[b].group,i.own_group_id=i.participant_obj[b].group_id,i.is_audience_or_debater="debater",i.own_side=i.participant_obj[b].side);console.log("update_member_variable"),console.log(i.own_role_array),console.log(i.own_group),console.log(i.own_group_id),console.log(i.is_audience_or_debater)}function h(a){var b=0;for(var c in a)b++;return b}var i=new Object;i.debate_style=null,i.participant_obj=new Object,i.participant_obj_bp_open=new Object,i.participant_obj_bp_close=new Object,i.audience_array=new Array,i.own_group=null,i.is_audience_or_debater="Audience",i.own_first_name=null,i.own_last_name=null,i.all_group_name=new Array,i.own_role_array=new Array,i.all_group_name_array=new Array,i.user_object_data=new Object;var j=new Firebase(a.firebase_url),k=new Object,l=null,m=new Object,n=new Object,o=0,p=(new Object,j.child("event_related/game/"+a.event_id+"/deb_style"));p.on("value",function(a){l=a.val(),b(function(){i.debate_style=l}),e()},function(a){console.log("The read failed: "+a.code)});var q=j.child("event_related/participants/"+a.event_id+"/full");q.on("value",function(a){var b=a.val();m=b?b:new Object,c(m)},function(a){console.log("The read failed: "+a.code)});var j=new Firebase(a.firebase_url),r=j.child("event_related/hangout_dynamic/"+a.event_id+"/mapping_data");r.on("value",function(a){var b=a.val();a.key();n=b?b:new Object,e()},function(a){console.log("The read failed: "+a.code)});var s=j.child("event_related/participants/"+a.event_id+"/game_role/");return s.on("value",function(a){var b=a.val();k=b?b:new Object,e()},function(a){console.log("The read failed: "+a.code)}),i.get_hangout_id=function(a){},i.get_user_info=function(a){},i.get_user_pict=function(a){i.user_object_data[a].profile_pict},i}]),angular.module("angularFireHangoutApp").service("RecognitionService",["MixideaSetting",function(a){function b(a){console.log(a);var b=Date.now(),c=b-i,d=g.child("context"),e=new Object;e[c]=a,d.update(e)}var c=!1,d=!0,e="aaaa",f=new Firebase(a.firebase_url),g=null,h=null,i=0;if(!window.webkitSpeechRecognition)return void(d=!1);var j=new webkitSpeechRecognition;j.continuous=!0,j.lang="en-US",j.onresult=function(a){for(var c=a.results,d=a.resultIndex;d<c.length;d++)c[d].isFinal&&b(c[d][0].transcript)},this.start=function(b,k,l){if(d){i=l,e=Date.now(),h=b,g=f.child("event_related/audio_transcript/"+a.event_id+"/"+k+"/"+String(i)+"/spech_context/"+e);var m={user:a.own_user_id,type:h};g.update(m),c||(console.log("recognition start"),j.start(),c=!0)}},this.stop=function(){console.log("record stop"),d&&c&&(j.stop(),c=!1)}}]),angular.module("angularFireHangoutApp").service("RecordingService",["MixideaSetting",function(a){function b(){m=io.connect(a.recording_domain),m.on("connect",function(){console.log("connect socket id="+m.id),k=!0,m.emit("join_room",{room_name:a.event_id}),m.on("audio_saved",function(a){console.log("record complete "+a.file_saved),audio_transcript_obj.update()}),m.on("disconnect",function(){console.log("disconnected"),k=!1,n&&(console.log("disconnected"),r=!1,n.end(),n=null)})})}function c(){navigator.getUserMedia||(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia),navigator.getUserMedia?(console.log("get user media"),navigator.getUserMedia({audio:!0},function(a){j=!0,h(a)},function(a){console.log("Error")})):console.log("getUserMedia not supported")}function d(a){if(k&&j)if(n)console.log("recording is already on going");else{console.log(" start record socket id="+m.id),console.log("start recording"),n=ss.createStream(),console.log("audio polling stream id "+n.id);var b={filename:a,sample_rate:p};console.log(b),ss(m).emit("audio_record_start",n,b)}}function e(a){k&&j&&(n?console.log("recording is already on going"):(console.log("resume recording"),n=ss.createStream(),console.log("audio polling stream id "+n.id),ss(m).emit("audio_record_resume",n,{filename:a,sample_rate:p})))}function f(a){k&&j&&(console.log("suspend recording"),n&&(n.end(),n=null,m.emit("audio_record_suspend",{filename:a})))}function g(b,c,d){if(k&&j&&(console.log("stop recording"),n)){console.log("stop record socket id="+m.id),n.end(),n=null;var e=a.event_id,f={filename:b,role_name:c,room_name:e,speech_id:d};console.log(f),m.emit("audio_record_end",f)}}function h(a){var b=window.AudioContext||window.webkitAudioContext;o=new b,p=o.sampleRate;var c=o.createMediaStreamSource(a),d=4096;q=o.createScriptProcessor(d,1,1),c.connect(q),q.connect(o.destination),q.onaudioprocess=function(a){if(r&&m){var b=a.inputBuffer.getChannelData(0),c=i(b),d=new ss.Buffer(c);n.write(d,"buffer")}}}function i(a){for(var b=a.length,c=2*b,d=new Uint8Array(c),e=new Int16Array(1),f=0;b>f;f++)e[0]=32767*a[f],d[2*f]=255&e[0],d[2*f+1]=(65280&e[0])>>8;return d.buffer}var j=!1,k=!1,l=null,m=null,n=null,o=null,p=null,q=null,r=!1;this.record_start_api=function(b,c,f){if(console.log("record start"),j&&k){r=!0;var g=a.event_id+"_"+c+"_"+f;switch(b){case"speech":l==f?e(g):d(g);break;case"poi":e(g)}l=f}},this.record_finish_api=function(b,c,d){if(j&&k&&r){r=!1;var e=a.event_id+"_"+c+"_"+d;switch(b){case"break":g(e,c,d);break;case"other":f(e)}}},b(),c()}]),angular.module("angularFireHangoutApp").service("SoundPlayService",["MixideaSetting",function(a){function b(a,b,c){this.context=a,this.urlList=b,this.onload=c,this.bufferList=new Array,this.loadCount=0}function c(c,g){e=new b(f,[a.source_domain+"audio/pointofinformation.mp3",a.source_domain+"audio/hearhear.mp3",a.source_domain+"audio/shame.mp3",a.source_domain+"audio/taken.mp3",a.source_domain+"audio/gobacktospeaker.mp3",a.source_domain+"audio/OnePin.mp3",a.source_domain+"audio/TwoPin.mp3",a.source_domain+"audio/ThreePin.mp3",a.source_domain+"audio/cursor1.mp3",a.source_domain+"audio/speech_start.mp3"],d),e.load()}function d(a){g.Poi_sound=f.createBufferSource(),g.Poi_sound.buffer=a[0],g.Poi_sound_persisted_buffer=a[0],g.Poi_sound.connect(f.destination),g.HearHear_sound=f.createBufferSource(),g.HearHear_sound.buffer=a[1],g.HearHear_sound_persisted_buffer=a[1],g.HearHear_sound.connect(f.destination),g.BooBoo_sound=f.createBufferSource(),g.BooBoo_sound.buffer=a[2],g.BooBoo_sound_persisted_buffer=a[2],g.BooBoo_sound.connect(f.destination),g.Taken_sound=f.createBufferSource(),g.Taken_sound.buffer=a[3],g.Taken_sound_persisted_buffer=a[3],g.Taken_sound.connect(f.destination),g.PoiFinish_sound=f.createBufferSource(),g.PoiFinish_sound.buffer=a[4],g.PoiFinish_sound_persisted_buffer=a[4],g.PoiFinish_sound.connect(f.destination),g.PinOne_sound=f.createBufferSource(),g.PinOne_sound.buffer=a[5],g.PinOne_sound_persisted_buffer=a[5],g.PinOne_sound.connect(f.destination),g.PinTwo_sound=f.createBufferSource(),g.PinTwo_sound.buffer=a[6],g.PinTwo_sound_persisted_buffer=a[6],g.PinTwo_sound.connect(f.destination),g.PinThree_sound=f.createBufferSource(),g.PinThree_sound.buffer=a[7],g.PinThree_sound_persisted_buffer=a[7],g.PinThree_sound.connect(f.destination),g.Cursol_sound=f.createBufferSource(),g.Cursol_sound.buffer=a[8],g.Cursol_sound_persisted_buffer=a[8],g.Cursol_sound.connect(f.destination),g.SpeechStart_sound=f.createBufferSource(),g.SpeechStart_sound.buffer=a[9],g.SpeechStart_sound_persisted_buffer=a[9],g.SpeechStart_sound.connect(f.destination)}this.Poi=function(){console.log("pin one"),g.PinOne_sound&&(g.Poi_sound.start(0),g.Poi_sound=f.createBufferSource(),g.Poi_sound.buffer=g.Poi_sound_persisted_buffer,g.Poi_sound.connect(f.destination))},this.HearHear=function(){console.log("speech start"),g.SpeechStart_sound&&(g.HearHear_sound.start(0),g.HearHear_sound=f.createBufferSource(),g.HearHear_sound.buffer=g.HearHear_sound_persisted_buffer,g.HearHear_sound.connect(f.destination))},this.BooBoo=function(){console.log("speech start"),g.SpeechStart_sound&&(g.BooBoo_sound.start(0),g.BooBoo_sound=f.createBufferSource(),g.BooBoo_sound.buffer=g.BooBoo_sound_persisted_buffer,g.BooBoo_sound.connect(f.destination))},this.Taken=function(){console.log("speech start"),g.SpeechStart_sound&&(g.Taken_sound.start(0),g.Taken_sound=f.createBufferSource(),g.Taken_sound.buffer=g.Taken_sound_persisted_buffer,g.Taken_sound.connect(f.destination))},this.PoiFinish=function(){console.log("speech start"),g.SpeechStart_sound&&(g.PoiFinish_sound.start(0),g.PoiFinish_sound=f.createBufferSource(),g.PoiFinish_sound.buffer=g.PoiFinish_sound_persisted_buffer,g.PoiFinish_sound.connect(f.destination))},this.PinOne=function(){console.log("speech start"),g.SpeechStart_sound&&(g.PinOne_sound.start(0),g.PinOne_sound=f.createBufferSource(),g.PinOne_sound.buffer=g.PinOne_sound_persisted_buffer,g.PinOne_sound.connect(f.destination))},this.PinTwo=function(){console.log("speech start"),g.SpeechStart_sound&&(g.PinTwo_sound.start(0),g.PinTwo_sound=f.createBufferSource(),g.PinTwo_sound.buffer=g.PinTwo_sound_persisted_buffer,g.PinTwo_sound.connect(f.destination))},this.PinThree=function(){console.log("speech start"),g.SpeechStart_sound&&(g.PinThree_sound.start(0),g.PinThree_sound=f.createBufferSource(),g.PinThree_sound.buffer=g.PinThree_sound_persisted_buffer,g.PinThree_sound.connect(f.destination))},this.Cursol=function(){console.log("speech start"),g.SpeechStart_sound&&(g.Cursol_sound.start(0),g.Cursol_sound=f.createBufferSource(),g.Cursol_sound.buffer=g.Cursol_sound_persisted_buffer,g.Cursol_sound.connect(f.destination))},this.SpeechStart=function(){console.log("speech start"),g.SpeechStart_sound&&(g.SpeechStart_sound.start(0),g.SpeechStart_sound=f.createBufferSource(),g.SpeechStart_sound.buffer=g.SpeechStart_sound_persisted_buffer,g.SpeechStart_sound.connect(f.destination))},b.prototype.loadBuffer=function(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.responseType="arraybuffer";var d=this;c.onload=function(){d.context.decodeAudioData(c.response,function(c){return c?(d.bufferList[b]=c,void(++d.loadCount==d.urlList.length&&d.onload(d.bufferList))):void alert("error decoding file data: "+a)},function(a){console.error("decodeAudioData error",a)})},c.onerror=function(){alert("BufferLoader: XHR error")},c.send()},b.prototype.load=function(){for(var a=0;a<this.urlList.length;++a)this.loadBuffer(this.urlList[a],a)};var e=null;window.AudioContext=window.AudioContext||window.webkitAudioContext;var f=new AudioContext,g=new Object;c()}]),angular.module("angularFireHangoutApp").factory("StatusMgrService",["MixideaSetting","$state",function(a,b){var c=new Object;c.game_status=null;var d=new Firebase(a.firebase_url),e=d.child("event_related/game/"+a.event_id+"/game_status");return e.on("value",function(a){var d=a.val();d!=c.game_status&&(c.game_status=d,"reflection"==d?b.go("main.reflection.write_article"):b.go("main."+d))},function(a){console.log("The read failed: "+a.code)}),c}]),angular.module("angularFireHangoutApp").service("UtilService",function(){this.get_full_role_name=function(a){switch(a){case"PM":return"Prime Minister";case"LO":return"Leader Opposition";case"MG":return"Member Government";case"MO":return"Member Opposition";case"PMR":return"Prime Minister Reply";case"LOR":return"Leader Opposition Reply";case"DPM":return"Depty Prime Minister";case"DLO":return"Depty Leader Opposition";case"WG":return"Whip Government";case"WO":return"Whip Opposition";case"GW":return"Govenment Whip";case"OW":return"Opposition Whip";default:return""}},this.add_linebreak_html=function(a){if(!a)return null;var b=a.split("<").join("&lt;");return b=b.split(">").join("&gt;"),b=b.split("\n").join("<br>")}}),angular.module("angularFireHangoutApp").controller("LinkMainroomCtrl",["$scope","MixideaSetting","$timeout",function(a,b,c){var d="?gid=",e=b.hangout_appid,f="&gd=",g=b.own_user_id,h=b.event_id,i="main",j=new Firebase(b.firebase_url),k=j.child("event_related/game_hangout_obj_list/"+b.event_id+"/main");k.on("value",function(b){c(function(){var c=b.val();a.hangout_url=c+d+e+f+g+"^"+h+"^"+i})},function(a){console.log("The read failed: "+a.code)})}]),angular.module("angularFireHangoutApp").controller("TeamdiscussArgumentsCtrl",["$scope","MixideaSetting","$timeout",function(a,b,c){function d(){var b="event_related/Article_Context/"+f+"/identifier/"+g+"/"+e+"/arguments",d=h.child(b);d.on("child_added",function(b,d){var h=b.key();c(function(){a.arg_list.push({arg_id:h,event_id:f,team:e,deb_style:g})})}),d.on("child_removed",function(b,d){for(var e=b.key(),f=(a.arg_list,-1),g=0;g<a.arg_list.length;g++)a.arg_list[g].arg_id==e&&(f=g);-1!=f&&c(function(){a.arg_list.splice(f,1)})});var i="event_related/Article_Context/"+f+"/identifier/"+g+"/"+e+"/def_intro",j=h.child(i);j.on("child_added",function(b,d){var e=b.key();c(function(){a.defintro_list.push({arg_id:e})})}),a.add_argument=function(){console.log("add argument");var a={dummy:!0};d.push(a)}}a.arg_list=new Array,a.defintro_list=new Array;var e=b.team_discuss_team_side,f=b.event_id,g=null,h=new Firebase("https://mixidea.firebaseio.com/"),i=h.child("event_related/game/"+f+"/deb_style");i.on("value",function(a){g=a.val(),d()},function(a){alert("fail to retrieve debate style"+a.code)}),a.name="kkkk"}]),angular.module("angularFireHangoutApp").controller("TeamdiscussRoomnameCtrl",["$scope","MixideaSetting",function(a,b){a.room_name=b.team_discuss_team_side}]);